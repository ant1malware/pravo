import{j as t}from"./index-CqvaTg_U.js";import{b as y,R as c,L as i}from"./react-vendor-DTkXckhQ.js";import{listSections as N}from"./forumRemote-D5s3MT8n.js";import{ax as S,aw as E,U as L,ac as $}from"./icons-GyIOUIPt.js";const b="forum:default_feed";function C(){try{const e=localStorage.getItem(b);if(e==="hot"||e==="new"||e==="questions")return e}catch{}return"hot"}function F(e){try{localStorage.setItem(b,e)}catch{}}const x="app:lang";function u(){try{const e=localStorage.getItem(x);if(e==="ru"||e==="en")return e}catch{}return"ru"}function I(e){try{localStorage.setItem(x,e)}catch{}try{const n=new Event("i18n:change");window.dispatchEvent(n)}catch{}}function g(e,n){return u()==="ru"?e:n}function D(){const e=y(),[n,m]=c.useState(null);c.useEffect(()=>{let s=!0;return(async()=>{try{const a=(await N()||[]).find(r=>String(r.title||"").toLowerCase()==="workshop");s&&m((a==null?void 0:a.id)||null)}catch{s&&m(null)}})(),()=>{s=!1}},[]);const d=e.pathname.includes("/forum/members"),f=n?e.pathname.startsWith(`/forum/section/${n}`):!1,w=!d&&!f,h=new URLSearchParams(e.search||"").get("feed"),p=({to:s,active:l,icon:a,children:r,disabled:k})=>k?t.jsxs("span",{className:`btn inline-flex items-center gap-2 ${l?"btn-primary":""}`,title:"Workshop section is not created yet","aria-disabled":!0,children:[a," ",r]}):t.jsxs(i,{to:s,className:`btn inline-flex items-center gap-2 ${l?"btn-primary":""}`,children:[a," ",r]}),[v,o]=c.useState(!1);c.useEffect(()=>{const s=()=>o(!1);return document.addEventListener("click",s),()=>document.removeEventListener("click",s)},[]);const j=C();return t.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[t.jsxs("div",{className:"relative",onClick:s=>s.stopPropagation(),children:[t.jsxs("button",{className:`btn inline-flex items-center gap-2 ${w?"btn-primary":""}`,onClick:()=>o(s=>!s),children:[t.jsx(S,{size:16})," Forums ",t.jsx(E,{size:14})]}),v&&t.jsxs("div",{className:"absolute left-0 z-20 mt-1 w-64 rounded-xl border border-white/10 bg-[color:var(--surface)] p-1 shadow-lg",children:[t.jsx(i,{className:`block rounded-lg px-3 py-2 hover:bg-white/5 ${h==="hot"?"bg-white/5":""}`,to:"/forum/feeds?feed=hot",onClick:()=>{o(!1)},children:"Горячее"}),t.jsx(i,{className:`block rounded-lg px-3 py-2 hover:bg-white/5 ${h==="new"?"bg-white/5":""}`,to:"/forum/feeds?feed=new",onClick:()=>{o(!1)},children:"Новое"}),t.jsx(i,{className:`block rounded-lg px-3 py-2 hover:bg-white/5 ${e.pathname.includes("/forum/questions")?"bg-white/5":""}`,to:"/forum/questions",onClick:()=>o(!1),children:"Вопросы"}),t.jsxs("div",{className:"mt-1 border-t border-white/10 p-2 text-xs opacity-80",children:["Лента по умолчанию:",["hot","new","questions"].map(s=>t.jsx("button",{className:`ml-2 tab ${j===s?"tab-active":""}`,onClick:()=>{F(s),o(!1)},children:s},s))]})]})]}),t.jsx(p,{to:"/forum/members",active:d,icon:t.jsx(L,{size:16}),children:"Members"}),t.jsx(p,{to:n?`/forum/section/${n}`:"/forum",active:f,icon:t.jsx($,{size:16}),disabled:!n,children:"Workshop"}),t.jsx("div",{className:"ml-auto"}),t.jsx("button",{className:"btn text-xs",onClick:()=>I(u()==="ru"?"en":"ru"),title:g("Переключить язык","Toggle language"),"aria-label":g("Переключить язык","Toggle language"),children:u()==="ru"?"RU":"EN"})]})}export{D as F,C as g,g as t};
