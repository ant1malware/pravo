import{j as e,m as T,b as U,h as M}from"./index-CYdCxHGe.js";import{e as B,R as j,L as N}from"./react-vendor-DTkXckhQ.js";import{F as O}from"./ForumSubnav-CDsN6-0d.js";import{l as A,g as P}from"./forumStore-CjtjVRB8.js";import{n as q,a as G,z as I}from"./icons-vKdVo13Z.js";import"./forumRemote-D5s3MT8n.js";function K({posts:s=0,likes:r=0,topics:l=0}){return l*4+s*1+r*2}function Q(s){return s>=1e3?{name:"Expert",color:"#22c55e"}:s>=500?{name:"Gold",color:"#eab308"}:s>=250?{name:"Silver",color:"#a1a1aa"}:s>=100?{name:"Bronze",color:"#d97706"}:{name:"Newbie",color:"#8b5cf6"}}function Y({points:s}){const r=Q(s);return e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs",style:{borderColor:"var(--border)",background:"var(--surface-2)",color:r.color},children:[e.jsx("span",{className:"h-2 w-2 rounded-full",style:{background:r.color}}),r.name," • ",s," pts"]})}const H=new Intl.DateTimeFormat("en-US",{day:"2-digit",month:"short",year:"numeric"}),J={developer:{label:"Developer",color:"#22d3ee"},admin:{label:"Admin",color:"#ef4444"},moderator:{label:"Moderator",color:"#8b5cf6"},vip:{label:"Premium",color:"#eab308"},user:{label:"User",color:"#94a3b8"},newbie:{label:"Newbie",color:"#22d3ee"}};function V({role:s}){const r=J[s]||{label:s,color:"#94a3b8"};return e.jsx("span",{className:"rounded-full border border-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.26em]",style:{color:r.color},children:r.label})}function z({member:s}){const r=s.profile.accentFrom||"#22d3ee",l=s.profile.accentTo||"#8b5cf6",x=s.username.slice(0,2).toUpperCase();return e.jsx("div",{className:"relative h-16 w-16 overflow-hidden rounded-2xl border border-white/10 shadow-[0_20px_45px_-25px_rgba(15,23,42,0.9)]",children:s.profile.avatarData?e.jsx("img",{src:s.profile.avatarData,alt:s.username,className:"h-full w-full object-cover",loading:"lazy"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center",style:{background:`linear-gradient(135deg, ${r}, ${l})`},children:e.jsx("span",{className:"text-lg font-semibold uppercase tracking-wide text-white/90",children:x})})})}function y(s){if(typeof s.score=="number")return s.score;const r=s.stats||{},l=typeof r.posts=="number"?r.posts:s.posts,x=typeof r.likes=="number"?r.likes:s.likes,h=typeof r.topics=="number"?r.topics:s.topics;return K({posts:l,likes:x,topics:h})}function W({member:s,highlight:r}){const l=s.stats||{},x=typeof l.posts=="number"?l.posts:s.posts,h=typeof l.topics=="number"?l.topics:s.topics,b=typeof l.likes=="number"?l.likes:s.likes,g=y(s),m=s.profile.accentFrom||"#22d3ee";s.profile.accentTo;const p=s.createdAt?H.format(new Date(s.createdAt)):"";return e.jsxs(N,{to:`/forum/profile/${s.username}`,className:`group relative overflow-hidden rounded-3xl border border-white/10 bg-white/[0.04] p-5 transition-all duration-200 hover:-translate-y-0.5 hover:border-cyan-400/60 hover:bg-white/[0.06] ${r?"border-cyan-400/70 ring-2 ring-cyan-400/30":""}`,children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 opacity-80 transition duration-300 group-hover:opacity-100",style:{background:`linear-gradient(130deg, ${m}22, transparent 55%)`}}),e.jsx("div",{className:"pointer-events-none absolute inset-0 opacity-0 transition duration-300 group-hover:opacity-40",style:{background:"radial-gradient(160% 120% at 0% 0%, rgba(34,211,238,0.18), transparent 60%)"}}),e.jsxs("div",{className:"relative flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(z,{member:s}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"truncate text-lg font-semibold text-white",children:s.username}),e.jsx(V,{role:s.role}),e.jsx(Y,{points:g}),r&&e.jsx("span",{className:"rounded-full bg-cyan-500/20 px-2 py-0.5 text-[11px] uppercase tracking-[0.3em] text-cyan-200",children:"Это вы"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-zinc-300/80",children:[e.jsxs("span",{children:["#",s.userNumber]}),e.jsx("span",{className:"hidden sm:inline",children:"•"}),e.jsxs("span",{children:["С нами с ",p]})]}),s.profile.bio&&e.jsx("p",{className:"line-clamp-2 text-sm text-zinc-200/85",children:s.profile.bio})]}),e.jsx(I,{size:16,className:"mt-1 opacity-0 transition-all duration-200 group-hover:translate-x-1 group-hover:opacity-100"})]}),e.jsx("div",{className:"grid gap-2 sm:grid-cols-3",children:[{label:"Темы",value:h},{label:"Посты",value:x},{label:"Лайки",value:b}].map(v=>e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/[0.05] px-3 py-2 text-center backdrop-blur-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:v.value}),e.jsx("div",{className:"mt-1 text-[10px] uppercase tracking-[0.28em] text-zinc-300/75",children:v.label})]},v.label))})]})]})}function re(){const s=B(),[r,l]=j.useState(()=>A()),[x,h]=j.useState(""),[b,g]=j.useState(null);j.useEffect(()=>{const a=async()=>{try{const o=await U(),u=await M();if(o||u!=null&&u.length){const w=u.map(d=>{const t=d.profile||null,i=d.stats||null,D=(t==null?void 0:t.accentFrom)||"#22d3ee",_=(t==null?void 0:t.accentTo)||"#8b5cf6",F=(t==null?void 0:t.avatarData)||(t==null?void 0:t.avatar)||(t==null?void 0:t.avatarUrl)||(t==null?void 0:t.avatarURL)||(t==null?void 0:t.image)||(t==null?void 0:t.photo)||(t==null?void 0:t.picture)||void 0,$=(t==null?void 0:t.bannerData)||(t==null?void 0:t.banner)||(t==null?void 0:t.bannerUrl)||(t==null?void 0:t.bannerURL)||void 0,E=typeof(i==null?void 0:i.posts)=="number"?i.posts:0,C=typeof(i==null?void 0:i.likes)=="number"?i.likes:0,R=typeof(i==null?void 0:i.topics)=="number"?i.topics:0,k=d.lastActiveAt||d.lastSeenAt||d.lastOnlineAt||null,f={id:d.id,username:d.username,email:`${d.username}@hidden.local`,createdAt:d.createdAt,role:d.role,userNumber:d.userNumber,posts:E,likes:C,topics:R,profile:{bio:(t==null?void 0:t.bio)||"",signature:(t==null?void 0:t.signature)||"",links:(t==null?void 0:t.links)||{},accentFrom:D,accentTo:_,avatarData:F,bannerData:$,badges:(t==null?void 0:t.badges)||[],privacy:{showEmail:!1,showStats:!0,...(t==null?void 0:t.privacy)||{}}},bans:null,mutes:null};return t!=null&&t.labels&&(f.profile.labels=t.labels),i&&(f.stats=i,typeof i.score=="number"&&(f.score=i.score)),k&&(f.lastActiveAt=k),f});l(w),g(o?{id:o.id,username:o.username}:null);return}}catch{}l(A());const c=P();if(g(c?{id:c.id,username:c.username}:null),!c)try{s("/forum",{replace:!0})}catch{}};a();const n=()=>a();return window.addEventListener("forum:session",n),window.addEventListener("storage",n),()=>{window.removeEventListener("forum:session",n),window.removeEventListener("storage",n)}},[]);const m=x.trim().toLowerCase(),p=r.filter(a=>m?a.username.toLowerCase().includes(m)||a.email.toLowerCase().includes(m)||a.role.toLowerCase().includes(m):!0).sort((a,n)=>{const c=y(n)-y(a);return c!==0?c:a.username.localeCompare(n.username)}),v=r.filter(a=>a.role==="developer"),S=r.filter(a=>a.role==="admin"),L=r.filter(a=>a.role==="moderator");return e.jsx("main",{className:"min-h-screen text-slate-100",style:{background:"radial-gradient(1200px 680px at 15% -10%, rgba(56,189,248,0.18), transparent 65%), radial-gradient(1100px 720px at 90% -6%, rgba(167,139,250,0.14), transparent 70%), linear-gradient(180deg, #04060d 0%, #090b16 100%)"},children:e.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-8",children:[e.jsx(O,{}),e.jsxs("section",{className:"relative mb-6 overflow-hidden rounded-3xl border border-white/10 bg-[#101527]/85 p-6 shadow-[0_50px_120px_-60px_rgba(15,23,42,0.9)] backdrop-blur",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-br from-sky-500/20 via-transparent to-fuchsia-500/10"}),e.jsx("div",{className:"pointer-events-none absolute -right-12 top-10 h-44 w-44 rounded-full bg-sky-400/20 blur-3xl"}),e.jsxs("div",{className:"relative flex flex-wrap items-center gap-6",children:[e.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-cyan-400/20 text-cyan-200 shadow-inner shadow-cyan-500/20",children:e.jsx(q,{size:22})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsx("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.36em] text-zinc-200/80",children:"Сообщество SKY"}),e.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-white sm:text-4xl",children:"Участники форума"}),e.jsx("p",{className:"max-w-2xl text-sm text-zinc-300/85 sm:text-base",children:"Найдите любого участника, изучите профиль и узнайте, чем живёт команда. Здесь собираются будущие напарники и эксперты, готовые к совместной работе."})]}),e.jsxs("div",{className:"grid gap-3 text-right text-xs uppercase tracking-[0.32em] text-zinc-300/70 sm:text-sm",children:[e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 px-4 py-3 shadow-inner shadow-black/40",children:[e.jsx("div",{className:"text-2xl font-bold tracking-tight text-white",children:r.length}),e.jsx("div",{children:"участников"})]}),e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 px-4 py-3 shadow-inner shadow-black/40",children:[e.jsx("div",{className:"text-2xl font-bold tracking-tight text-white",children:p.length}),e.jsx("div",{children:"в подборке"})]})]})]})]}),(()=>{const a=Date.now(),n=5*60*1e3,c=r.filter(o=>{const u=o.lastActiveAt;if(!u)return!1;const w=new Date(u).getTime();return!Number.isNaN(w)&&w>a-n});return c.length?e.jsxs("section",{className:"mb-6 rounded-3xl border border-white/10 bg-white/[0.05] p-4 backdrop-blur",children:[e.jsx("div",{className:"mb-3 text-xs uppercase tracking-[0.32em] text-emerald-200/80",children:"Online now"}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:c.slice(0,12).map(o=>e.jsxs(N,{to:`/forum/profile/${o.username}`,className:"flex items-center gap-3 rounded-xl border border-white/10 bg-white/5 px-3 py-2 hover:border-emerald-400/50",children:[e.jsx(z,{member:o}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate font-semibold text-white",children:o.username}),e.jsx("div",{className:"text-[11px] uppercase tracking-[0.28em] text-zinc-300/70",children:T(o.lastActiveAt)})]})]},o.id))})]}):null})(),e.jsx("section",{className:"mb-6 grid gap-4 lg:grid-cols-3",children:[{title:"Разработчики",color:"text-cyan-200/80",entries:v,empty:"Пока нет разработчиков"},{title:"Администраторы",color:"text-rose-200/80",entries:S,empty:"Пока нет администраторов"},{title:"Модераторы",color:"text-violet-200/80",entries:L,empty:"Пока нет модераторов"}].map(a=>e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/[0.05] p-4 backdrop-blur shadow-[0_30px_90px_-60px_rgba(15,23,42,0.9)]",children:[e.jsx("div",{className:`mb-3 text-xs uppercase tracking-[0.32em] ${a.color}`,children:a.title}),e.jsxs("div",{className:"grid gap-2 text-sm text-zinc-200/85",children:[a.entries.slice(0,8).map(n=>{const c=n.profile.accentFrom||"#22d3ee",o=n.profile.accentTo||"#8b5cf6";return e.jsxs(N,{to:`/forum/profile/${n.username}`,className:"flex items-center gap-3 rounded-2xl border border-white/10 bg-white/5 px-3 py-2 transition hover:border-cyan-400/50",children:[e.jsx("div",{className:"h-8 w-8 rounded-xl border border-white/10",style:{background:n.profile.avatarData?`url(${n.profile.avatarData}) center/cover`:`linear-gradient(135deg, ${c}, ${o})`}}),e.jsx("span",{className:"font-semibold text-white",children:n.username})]},n.id)}),!a.entries.length&&e.jsx("div",{className:"text-xs text-zinc-400/70",children:a.empty})]})]},a.title))}),e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative min-w-[220px] flex-1",children:[e.jsx(G,{className:"pointer-events-none absolute left-4 top-1/2 h-4 w-4 -translate-y-1/2 text-zinc-400"}),e.jsx("input",{className:"input w-full rounded-2xl border-white/10 bg-white/[0.03] pl-11 text-sm text-white placeholder:text-zinc-400",placeholder:"Поиск по нику, почте или роли",value:x,onChange:a=>h(a.target.value)})]}),e.jsxs("div",{className:"text-xs uppercase tracking-[0.32em] text-zinc-400",children:["Показано ",p.length," / ",r.length]})]}),e.jsx("div",{className:"grid gap-5 md:grid-cols-2 xl:grid-cols-3",children:p.map(a=>e.jsx(W,{member:a,highlight:(b==null?void 0:b.id)===a.id},a.id))}),!p.length&&e.jsx("div",{className:"mt-6 rounded-3xl border border-white/10 bg-white/[0.05] p-5 text-sm text-zinc-300/80",children:"Нет участников по этому запросу."})]})})}export{re as default};
