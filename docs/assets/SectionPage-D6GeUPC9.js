import{j as e}from"./index-BBBHUoXu.js";import{u as k,R as r,L as N}from"./react-vendor-DTkXckhQ.js";import{l as S,b as C,d as W}from"./forumRemote-B4nbC4GM.js";import{F as $}from"./ForumSubnav-DX2CMo0F.js";import{M as P}from"./MarkdownEditor-DbDpl5HJ.js";import{ab as T,ac as B,ad as L}from"./icons-CI_uwdm-.js";import"./purify.es-DnfDK_hS.js";function M(){const{id:c=""}=k(),[a,p]=r.useState(null),[g,x]=r.useState([]),[u,f]=r.useState(""),[h,b]=r.useState(""),[v,j]=r.useState(!1),[n,o]=r.useState("all"),d=r.useCallback(async()=>{try{const[t,s]=await Promise.all([S(),C(c)]);p(t.find(l=>l.id===c)||null),x(Array.isArray(s)?s:[])}catch{p(null),x([])}},[c]);r.useEffect(()=>{d()},[d]);const i=((a==null?void 0:a.title)||"").toLowerCase()==="workshop",y=async t=>{t.preventDefault();const s=u.trim();if(s){j(!0);try{await W({sectionId:c,title:s,content:i?h:void 0}),f(""),b(""),d()}catch(l){alert((l==null?void 0:l.message)||"Failed to create topic")}finally{j(!1)}}};function m(t){const s=(t||"").toLowerCase();return s.startsWith("[wip]")?"wip":s.startsWith("[review]")?"review":s.startsWith("[done]")?"done":"none"}const w=g.filter(t=>n==="all"?!0:m(t.title)===n);return e.jsx("main",{className:"min-h-screen",style:{background:"radial-gradient(900px 620px at 18% -12%, rgba(59,130,246,0.18), transparent 65%), radial-gradient(1200px 760px at 92% 0%, rgba(236,72,153,0.16), transparent 68%), #0d0d12",color:"#f8fafc"},children:e.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-6",children:[e.jsx($,{}),e.jsxs("div",{className:"mb-5 flex items-center gap-3",children:[e.jsxs(N,{to:"/forum",className:"btn flex items-center gap-2",children:[e.jsx(T,{size:16})," Back"]}),e.jsx("div",{className:"text-sm opacity-70",children:"Section"}),e.jsx("div",{className:"font-semibold",children:(a==null?void 0:a.title)||"..."})]}),i&&e.jsxs("div",{className:"card mb-4 p-4",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 font-semibold",children:[e.jsx(B,{size:16})," Workshop: рекомендации"]}),e.jsx("div",{className:"text-sm opacity-70",children:"Добавляйте префиксы статуса в заголовок: [WIP], [Review], [Done]. Пишите краткое описание, технологический стек и прогресс — будет проще ревьюить."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2 text-xs",children:[e.jsx("button",{className:`tab ${n==="all"?"tab-active":""}`,onClick:()=>o("all"),children:"All"}),e.jsx("button",{className:`tab ${n==="wip"?"tab-active":""}`,onClick:()=>o("wip"),children:"[WIP]"}),e.jsx("button",{className:`tab ${n==="review"?"tab-active":""}`,onClick:()=>o("review"),children:"[Review]"}),e.jsx("button",{className:`tab ${n==="done"?"tab-active":""}`,onClick:()=>o("done"),children:"[Done]"})]})]}),e.jsxs("form",{onSubmit:y,className:"card mb-4 grid gap-2 p-4",children:[e.jsx("input",{className:"input",placeholder:i?"[WIP] Короткий заголовок проекта":"Topic title",value:u,onChange:t=>f(t.target.value),disabled:v}),i&&e.jsx(P,{value:h,onChange:b,placeholder:"Описание проекта...",projectTemplate:!0,draftKey:a?`forum:draft:new:${a.id}`:void 0}),e.jsxs("button",{className:"btn btn-primary flex items-center gap-2",disabled:v,children:[e.jsx(L,{size:16})," ",i?"Создать проект":"Создать тему"]})]}),e.jsxs("div",{className:"grid gap-3",children:[w.map(t=>e.jsxs(N,{to:`/forum/topic/${t.id}`,className:`card p-4 ${i?"grid grid-cols-[1fr_auto] items-center":""}`,children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"font-semibold truncate",children:[i&&m(t.title)!=="none"&&e.jsx("span",{className:"mr-2 inline-block rounded bg-white/10 px-2 py-0.5 text-xs",children:`[${m(t.title).toUpperCase()}]`}),t.title]}),e.jsxs("div",{className:"mt-1 text-xs opacity-70",children:["replies: ",t.replyCount," • views: ",t.viewCount]})]}),i&&e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-emerald-300/80",children:"Проект"})]},t.id)),!w.length&&e.jsx("div",{className:"card p-4 text-sm opacity-70",children:"No topics yet."})]})]})})}export{M as default};
