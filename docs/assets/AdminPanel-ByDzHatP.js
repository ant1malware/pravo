import{j as e}from"./index-DG-b-6oy.js";import{R as l}from"./react-vendor-DTkXckhQ.js";import{l as g,c as j,d as N,e as b,h as u,m as f}from"./forumStore-C1mEitkW.js";import{l as y,s as k,b as w,d as C}from"./authRemote-DRv3ZFbe.js";import"./icons-DET5c9ig.js";function x(){try{const a=localStorage.getItem("forum:session")??sessionStorage.getItem("forum:session");if(!a)return"unknown";const c=JSON.parse(a);return(c==null?void 0:c.userId)||"unknown"}catch{return"unknown"}}function F(){const[a,c]=l.useState("users");return e.jsxs("div",{className:"mx-auto w-full max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"mb-4 flex gap-2",children:[e.jsx("button",{className:`btn ${a==="users"?"btn-primary":""}`,onClick:()=>c("users"),children:"Users"}),e.jsx("button",{className:`btn ${a==="sections"?"btn-primary":""}`,onClick:()=>c("sections"),children:"Sections"}),e.jsx("button",{className:`btn ${a==="topics"?"btn-primary":""}`,onClick:()=>c("topics"),children:"Topics"}),e.jsx("button",{className:`btn ${a==="invites"?"btn-primary":""}`,onClick:()=>c("invites"),children:"Invites"})]}),a==="users"&&e.jsx(S,{}),a==="sections"&&e.jsx(_,{}),a==="topics"&&e.jsx(T,{}),a==="invites"&&e.jsx(I,{})]})}function S(){const[a,c]=l.useState([]),r=async()=>{try{const i=await y();c(i)}catch(i){alert((i==null?void 0:i.message)||"Failed to load users")}};l.useEffect(()=>{r()},[]);const m=async(i,o)=>{try{await k(i,o),r()}catch(t){alert((t==null?void 0:t.message)||"Failed to set role")}};return e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"mb-3 text-sm opacity-70",children:"���������� �������������� (����� Worker API)."}),e.jsxs("div",{className:"grid gap-2",children:[a.map(i=>e.jsxs("div",{className:"grid grid-cols-[80px_1fr_1fr_180px] items-center gap-3 rounded-xl border px-3 py-2",style:{borderColor:"var(--border)"},children:[e.jsxs("div",{className:"text-xs opacity-70",children:["#",i.userNumber]}),e.jsx("div",{className:"font-semibold",children:i.username}),e.jsx("div",{className:"text-sm opacity-80",children:i.email}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{className:"input",value:i.role,onChange:o=>m(i.id,o.target.value),children:[e.jsx("option",{value:"developer",children:"developer"}),e.jsx("option",{value:"admin",children:"admin"}),e.jsx("option",{value:"moderator",children:"moderator"}),e.jsx("option",{value:"vip",children:"vip"}),e.jsx("option",{value:"user",children:"user"}),e.jsx("option",{value:"newbie",children:"newbie"})]})})]},i.id)),!a.length&&e.jsx("div",{className:"text-sm opacity-70",children:"Нет пользователей"})]})]})}function _(){const[a,c]=l.useState([]),[r,m]=l.useState(""),[i,o]=l.useState(""),t=()=>c(g());l.useEffect(()=>{t()},[]);const n=()=>{r.trim()&&(j({title:r.trim(),description:i.trim()}),m(""),o(""),t())},s=(d,p,h)=>{const v=x();N(d,{[p]:h},v),t()};return e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"mb-2 font-semibold",children:"Создать раздел"}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-[1fr_1fr_auto]",children:[e.jsx("input",{className:"input",placeholder:"Title",value:r,onChange:d=>m(d.target.value)}),e.jsx("input",{className:"input",placeholder:"Description",value:i,onChange:d=>o(d.target.value)}),e.jsx("button",{className:"btn btn-primary",onClick:n,children:"Add"})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"mb-2 font-semibold",children:"Список разделов"}),e.jsxs("div",{className:"grid gap-2",children:[a.map(d=>e.jsxs("div",{className:"grid grid-cols-[140px_1fr] items-center gap-2 rounded-xl border px-3 py-2",style:{borderColor:"var(--border)"},children:[e.jsxs("div",{className:"text-sm opacity-70",children:[d.id.slice(0,8),"…"]}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[e.jsx("input",{className:"input",value:d.title,onChange:p=>s(d.id,"title",p.target.value)}),e.jsx("input",{className:"input",value:d.description||"",onChange:p=>s(d.id,"description",p.target.value)})]})]},d.id)),!a.length&&e.jsx("div",{className:"text-sm opacity-70",children:"Пока нет разделов"})]})]})]})}function T(){const[a,c]=l.useState([]),r=()=>c(b());l.useEffect(()=>{r()},[]);const m=(t,n)=>{const s=x();u(t,{pinned:n},s),r()},i=(t,n)=>{const s=x();u(t,{locked:n},s),r()},o=(t,n)=>{const s=x();n.trim()&&(f(t,n.trim(),s),r())};return e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"mb-2 font-semibold",children:"Темы"}),e.jsxs("div",{className:"grid gap-2",children:[a.map(t=>e.jsxs("div",{className:"grid grid-cols-1 items-center gap-3 rounded-xl border px-3 py-3 sm:grid-cols-[1fr_auto_auto_auto]",style:{borderColor:"var(--border)"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:t.title}),e.jsxs("div",{className:"text-xs opacity-70",children:["id: ",t.id.slice(0,8),"… • section: ",t.sectionId.slice(0,8),"…"]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!t.pinned,onChange:n=>m(t.id,n.target.checked)}),"pinned"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!t.locked,onChange:n=>i(t.id,n.target.checked)}),"locked"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",placeholder:"to sectionId",onKeyDown:n=>{if(n.key==="Enter"){const s=n.target.value;o(t.id,s),n.target.value=""}}}),e.jsx("button",{className:"btn",onClick:n=>{const s=n.currentTarget.previousElementSibling;o(t.id,s.value),s.value=""},children:"Move"})]})]},t.id)),!a.length&&e.jsx("div",{className:"text-sm opacity-70",children:"Пока нет тем"})]})]})}function I(){const[a,c]=l.useState([]),[r,m]=l.useState(5),[i,o]=l.useState(""),t=async()=>{try{c(await w())}catch(s){alert((s==null?void 0:s.message)||"Failed")}};l.useEffect(()=>{t()},[]);const n=async()=>{try{await C(Math.max(1,Math.min(20,r)),i),o(""),t()}catch(s){alert((s==null?void 0:s.message)||"Failed to generate")}};return e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"mb-3 font-semibold",children:"Генерация инвайт-кодов"}),e.jsxs("div",{className:"mb-4 grid gap-2 sm:grid-cols-[120px_1fr_auto]",children:[e.jsx("input",{className:"input",type:"number",min:1,max:20,value:r,onChange:s=>m(parseInt(s.target.value||"1",10))}),e.jsx("input",{className:"input",placeholder:"note (optional)",value:i,onChange:s=>o(s.target.value)}),e.jsx("button",{className:"btn btn-primary",onClick:n,children:"Generate"})]}),e.jsx("div",{className:"mb-2 text-sm opacity-70",children:"Последние коды (однократные):"}),e.jsxs("div",{className:"grid gap-2",children:[a.map(s=>e.jsxs("div",{className:"grid grid-cols-1 items-center gap-2 rounded-xl border px-3 py-2 sm:grid-cols-[160px_1fr_1fr_1fr]",style:{borderColor:"var(--border)"},children:[e.jsx("div",{className:"font-mono text-sm",children:s.code}),e.jsxs("div",{className:"text-xs opacity-70",children:["created: ",new Date(s.createdAt).toLocaleString()]}),e.jsx("div",{className:"text-xs",children:s.note||""}),e.jsx("div",{className:"text-xs",children:s.usedBy?e.jsx("span",{className:"text-emerald-400",children:"used"}):e.jsx("span",{className:"opacity-70",children:"unused"})})]},`${s.code}-${s.createdAt}`)),!a.length&&e.jsx("div",{className:"text-sm opacity-70",children:"Список пуст"})]})]})}export{F as default};
