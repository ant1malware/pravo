import{j as e}from"./index-DnIl2Liw.js";import{u as Pe,R as c}from"./react-vendor-DTkXckhQ.js";import{g as de,e as me,f as xe,a as ue,u as Le,h as De,j as we}from"./authRemote-C3m3kzk1.js";import{a0 as Fe,a1 as Re,a2 as Te,a3 as pe,a4 as fe,S as he,a5 as Be,a6 as _e,a7 as je,a8 as Me,M as Oe,a9 as Ue,aa as ge}from"./icons-CyHLH3i5.js";const Y="forum:",Z=`${Y}follows`,Ne=`${Y}profile_comments:`,We=`${Y}social-change`,W=new Map,Ge={getItem:s=>W.has(s)?W.get(s):null,setItem:(s,t)=>void W.set(s,t),removeItem:s=>void W.delete(s)},j=(()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{}return Ge})(),ye=typeof window<"u";function X(){return new Date().toISOString()}function ke(s,t){try{return s?JSON.parse(s):t}catch{return t}}function Se(){try{const s=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():null;if(s)return s}catch{}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const t=Math.random()*16|0;return(s==="x"?t:t&3|8).toString(16)})}function ee(s){if(ye)try{window.dispatchEvent(new CustomEvent(We,{detail:s}))}catch{}}ye&&window.addEventListener("storage",s=>{s.key&&(s.key.startsWith(Ne)||s.key===Z)&&ee({key:s.key,type:"storage"})});function K(){return ke(j.getItem(Z),[])}function Ce(s){const t=new Set,r=[];for(const a of s){const n=`${a.followerId}=>${a.targetId}`;a.followerId!==a.targetId&&(t.has(n)||(t.add(n),r.push(a)))}try{j.setItem(Z,JSON.stringify(r))}catch{}ee({scope:"follows"})}function G(s){return K().filter(t=>t.targetId===s).map(t=>t.followerId)}function Ve(s,t){return s?K().some(r=>r.followerId===s&&r.targetId===t):!1}function Je(s,t){if(!s||!t||s===t)return;const r=K();r.some(a=>a.followerId===s&&a.targetId===t)||(r.push({followerId:s,targetId:t,createdAt:X()}),Ce(r))}function Ye(s,t){const r=K().filter(a=>!(a.followerId===s&&a.targetId===t));Ce(r)}function Ie(s){return`${Ne}${s}`}function Xe(s){return s.map(t=>({id:t.id??Se(),targetId:t.targetId,authorId:t.authorId,authorName:t.authorName,content:typeof t.content=="string"?t.content:"",createdAt:t.createdAt??X(),parentId:t.parentId??null,updatedAt:t.updatedAt??null,edited:!!t.edited,deleted:!!t.deleted,deletedAt:t.deletedAt??null,deletedById:t.deletedById??null}))}function V(s){const t=j.getItem(Ie(s)),r=ke(t,[]);return Xe(r)}function Ae(s,t){try{j.setItem(Ie(s),JSON.stringify(t))}catch{}ee({scope:"comments",targetId:s})}const Ke=1e4;function qe(s,t){const r=`${Y}last_post:${s}:${t}`,a=Number(j.getItem(r)||"0"),n=Date.now()-a>=Ke;if(n)try{j.setItem(r,String(Date.now()))}catch{}return n}const be=2e3;function w(s,t){const r=V(s),n=!1?r:r.filter(o=>!o.deleted);n.sort((o,u)=>o.createdAt<u.createdAt?1:-1);const d=Math.max(0,0);return n.slice(d,void 0)}function Ee(s,t,r,a){const n=(r??"").trim();if(!n)throw new Error("Comment is empty");if(n.length>be)throw new Error(`Comment too long (${n.length} > ${be})`);if(!qe(s,t))throw new Error("You are posting too fast. Please wait a bit.");if(a!=null&&a.parentId&&!V(s).find(u=>u.id===a.parentId))throw new Error("Parent comment not found");const d={id:Se(),targetId:s,authorId:t,authorName:a==null?void 0:a.authorName,content:n,createdAt:X(),parentId:(a==null?void 0:a.parentId)??null,updatedAt:null,edited:!1,deleted:!1,deletedAt:null,deletedById:null},m=V(s);return m.unshift(d),Ae(s,m),d}function He(s,t,r,a,n){return Ee(s,t,a,{authorName:n,parentId:r})}function Qe(s,t,r){const a=V(s),n=a.findIndex(m=>m.id===t);if(n<0)return;const d=a[n];(d.authorId===r||s===r)&&(d.deleted||(a[n]={...d,content:"",deleted:!0,deletedAt:X(),deletedById:r},Ae(s,a)))}const ve={developer:{label:"Developer",color:"#22d3ee",glow:"from-cyan-400/35"},admin:{label:"Admin",color:"#ef4444",glow:"from-rose-400/35"},moderator:{label:"Moderator",color:"#8b5cf6",glow:"from-violet-400/35"},vip:{label:"VIP",color:"#eab308",glow:"from-amber-400/35"},user:{label:"User",color:"#94a3b8",glow:"from-slate-300/30"},newbie:{label:"Newbie",color:"#22d3ee",glow:"from-cyan-400/35"}},J={developer:{label:"Developer",grad:"from-cyan-400 via-fuchsia-400 to-cyan-400",Icon:fe},admin:{label:"Admin",grad:"from-rose-400 via-amber-400 to-rose-400",Icon:he},moderator:{label:"Moderator",grad:"from-violet-400 via-sky-400 to-violet-400",Icon:_e},vip:{label:"VIP",grad:"from-amber-400 via-rose-400 to-amber-400",Icon:Be},user:{label:"User",grad:"from-slate-300 via-slate-400 to-slate-300",Icon:he},newbie:{label:"Newbie",grad:"from-cyan-400 via-fuchsia-400 to-cyan-400",Icon:fe}};function Q({value:s,label:t}){return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-extrabold text-white",children:s}),e.jsx("div",{className:"mt-1 text-xs uppercase tracking-[0.3em] text-zinc-400/80",children:t})]})}function z({title:s,children:t,right:r}){return e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/70",children:s}),r]}),t]})}function Ze({role:s}){const t=J[s]??J.user,r=t.Icon;return e.jsxs("span",{className:"relative inline-flex",children:[e.jsx("span",{className:`absolute -inset-[2px] rounded-full blur-md bg-gradient-to-r ${t.grad} opacity-50`}),e.jsxs("span",{className:"relative inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3.5 py-1.5 text-[11px] font-extrabold uppercase tracking-[0.22em] text-white shadow-[0_0_0_1px_rgba(255,255,255,0.06)_inset]",children:[e.jsx(r,{size:14,className:"opacity-90"}),t.label]})]})}function et({role:s}){const t=J[s]??J.user;return e.jsx("span",{className:"rounded-full border border-white/15 bg-black/50 px-2 py-0.5 text-[10px] font-bold uppercase tracking-[0.18em] text-white backdrop-blur",style:{boxShadow:"0 0 16px rgba(255,255,255,0.08), inset 0 0 0 1px rgba(255,255,255,0.05)"},children:t.label})}const tt={Founder:"from-rose-500/25 to-rose-400/10 text-rose-200",Early:"from-sky-500/25 to-sky-400/10 text-sky-200",Contributor:"from-emerald-500/25 to-emerald-400/10 text-emerald-200",VIP:"from-amber-500/25 to-amber-400/10 text-amber-200",Designer:"from-violet-500/25 to-violet-400/10 text-violet-200"};function st({badges:s}){return!s||s.length===0?null:e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:s.slice(0,3).map(t=>{const r=tt[t]||"from-white/20 to-white/5 text-zinc-200";return e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full border border-white/10 bg-gradient-to-br ${r} px-2.5 py-1 text-xs`,title:`Badge: ${t}`,children:[e.jsx(je,{size:14,className:"opacity-90"})," ",t]},t)})})}function ut(){var L,y,D,k,F,S,R,C,T,I,B,A,_,E,M;const{username:s=""}=Pe(),[t,r]=c.useState(null),[a,n]=c.useState(null),[d,m]=c.useState(!1);c.useEffect(()=>{(async()=>{try{const x=await de();if(x){m(!0),n({id:x.id,username:x.username});const p=await me(s);if(p){const O={id:p.user.id,username:p.user.username,email:p.user.email,createdAt:p.user.createdAt,role:p.user.role,userNumber:p.user.userNumber,posts:0,likes:0,topics:0,profile:p.profile||{bio:"",signature:"",links:{},accentFrom:"#8b5cf6",accentTo:"#0ea5e9",badges:[],privacy:{showEmail:!1,showStats:!0,showLinks:!0,allowComments:!0,showFollowers:!0}},bans:null,mutes:null};r(O);return}}}catch{}m(!1),r(xe(s)||null);const i=ue();n(i?{id:i.id,username:i.username}:null)})()},[s]),c.useEffect(()=>{const i=async()=>{try{const p=await de();if(p){n({id:p.id,username:p.username});return}}catch{}const x=ue();n(x?{id:x.id,username:x.username}:null)};return window.addEventListener("forum:session",i),window.addEventListener("storage",i),()=>{window.removeEventListener("forum:session",i),window.removeEventListener("storage",i)}},[]);const o=(t==null?void 0:t.id)||"",[u,f]=c.useState(()=>o?G(o):[]),[b,g]=c.useState(()=>o?w(o):[]),v=c.useMemo(()=>Ve((a==null?void 0:a.id)||null,o),[a==null?void 0:a.id,o,u.length]);if(c.useEffect(()=>{if(!o){f([]),g([]);return}f(G(o)),g(w(o))},[o]),c.useEffect(()=>{const i=()=>{o&&(f(G(o)),g(w(o)))};return window.addEventListener("forum:social-change",i),()=>window.removeEventListener("forum:social-change",i)},[o]),!t)return e.jsx("main",{className:"min-h-screen bg-slate-950 text-slate-200",children:e.jsx("div",{className:"mx-auto max-w-3xl px-4 py-12",children:e.jsx("div",{className:"card p-6 text-center text-sm text-zinc-300",children:"Profile not found."})})});const q=(a==null?void 0:a.id)===t.id,N=t.profile.accentFrom||"#22d3ee",$=t.profile.accentTo||"#8b5cf6",P=ve[t.role]||ve.user;return e.jsx("main",{className:"min-h-screen",style:{background:"radial-gradient(900px 600px at 20% -10%, rgba(59,130,246,0.18), transparent 65%), radial-gradient(1100px 760px at 95% 8%, rgba(236,72,153,0.16), transparent 68%), #0d0d12",color:"#f8fafc"},children:e.jsxs("div",{className:"mx-auto max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-[200px] w-full",style:{background:t.profile.bannerData?`url(${t.profile.bannerData}) center/cover`:`linear-gradient(135deg, ${N}, ${$})`}}),e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/15 via-transparent to-black/50"}),e.jsx("div",{className:"pointer-events-none absolute inset-0",children:e.jsx("div",{className:"absolute right-8 top-6 h-24 w-24 rounded-full bg-gradient-to-br from-white/15 to-transparent blur-2xl"})})]}),e.jsxs("div",{className:"flex flex-wrap items-end gap-4 px-4 pb-5 -mt-16",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 rounded-full ring-4 ring-[rgba(13,19,33,0.85)] shadow-2xl",style:{background:t.profile.avatarData?`url(${t.profile.avatarData}) center/cover`:`linear-gradient(135deg, ${N}, ${$})`}}),e.jsx("div",{className:`absolute -inset-1 -z-10 rounded-full bg-gradient-to-br ${P.glow} to-transparent blur-lg`}),e.jsx("div",{className:"absolute -bottom-2 left-1",children:e.jsx(et,{role:t.role})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-extrabold text-white",children:t.username}),e.jsxs("span",{className:"text-xs text-zinc-400/80",children:["#",t.userNumber]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Ze,{role:t.role})}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-xs text-zinc-400/90",children:[e.jsxs("span",{children:["Joined ",new Date(t.createdAt).toLocaleDateString()]}),(L=t.profile.privacy)!=null&&L.showEmail&&t.email?e.jsx("span",{className:"rounded-full bg-white/[0.04] px-2 py-1",children:t.email}):null]}),e.jsx("div",{className:"mt-2",children:e.jsx(st,{badges:t.profile.badges})})]}),q?e.jsx(at,{user:t,onUpdated:async()=>{if(d){const i=await me(s);i&&r({id:i.user.id,username:i.user.username,email:i.user.email,createdAt:i.user.createdAt,role:i.user.role,userNumber:i.user.userNumber,posts:0,likes:0,topics:0,profile:i.profile,bans:null,mutes:null})}else r(xe(s)||null)},saveProfile:async i=>{d?await Le(i):De(t.id,i)}}):e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{className:`btn ${v?"":"btn-primary"}`,onClick:()=>{a!=null&&a.id&&(v?Ye(a.id,t.id):Je(a.id,t.id),f(G(t.id)))},children:v?e.jsxs(e.Fragment,{children:[e.jsx(Fe,{size:16})," Unfollow"]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:16})," Follow"]})})})]})]}),((D=(y=t.profile)==null?void 0:y.privacy)==null?void 0:D.showStats)!==!1&&e.jsxs("div",{className:"mt-6 grid gap-4 sm:grid-cols-3",children:[e.jsx("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-b from-white/5 to-white/[0.02] p-4 text-center",children:e.jsx(Q,{value:t.posts,label:"Posts"})}),e.jsx("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-b from-white/5 to-white/[0.02] p-4 text-center",children:e.jsx(Q,{value:t.topics,label:"Topics"})}),e.jsx("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-b from-white/5 to-white/[0.02] p-4 text-center",children:e.jsx(Q,{value:t.likes,label:"Likes"})})]}),e.jsxs("div",{className:"mt-6 grid gap-4 lg:grid-cols-[1.35fr_.85fr]",children:[e.jsx(z,{title:"About",children:e.jsx("p",{className:"whitespace-pre-wrap text-sm text-zinc-200/85",children:t.profile.bio||"No bio yet."})}),((F=(k=t.profile)==null?void 0:k.privacy)==null?void 0:F.showLinks)!==!1&&e.jsx(z,{title:"Links",children:e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-zinc-200/90",children:[((S=t.profile.links)==null?void 0:S.website)&&e.jsxs("a",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/[0.04] px-3 py-1 hover:bg-white/[0.08]",href:t.profile.links.website,target:"_blank",rel:"noreferrer",children:[e.jsx(Te,{size:14})," Website"]}),((R=t.profile.links)==null?void 0:R.discord)&&e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/[0.04] px-3 py-1",children:[e.jsx(pe,{size:14})," ",t.profile.links.discord]}),((C=t.profile.links)==null?void 0:C.telegram)&&e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/[0.04] px-3 py-1",children:[e.jsx(pe,{size:14})," ",t.profile.links.telegram]}),!((T=t.profile.links)!=null&&T.website)&&!((I=t.profile.links)!=null&&I.discord)&&!((B=t.profile.links)!=null&&B.telegram)&&e.jsx("span",{className:"opacity-70",children:"No links added."})]})})]}),e.jsx(z,{title:"Signature",children:e.jsx("div",{className:"whitespace-pre-wrap text-sm text-zinc-200/85",children:t.profile.signature||"No signature."})}),((_=(A=t.profile)==null?void 0:A.privacy)==null?void 0:_.showFollowers)!==!1&&e.jsx(z,{title:`Followers (${u.length})`,children:e.jsx("div",{className:"flex flex-wrap gap-2 text-sm text-zinc-200/90",children:u.length===0?e.jsx("span",{className:"opacity-70",children:"No followers yet."}):u.slice(0,18).map(i=>{const x=we(i);return e.jsx("span",{className:"rounded-full border border-white/10 bg-white/[0.04] px-3 py-1",children:(x==null?void 0:x.username)||"User"},i)})})}),((M=(E=t.profile)==null?void 0:E.privacy)==null?void 0:M.allowComments)!==!1&&e.jsx(z,{title:"Profile comments",children:e.jsxs("div",{className:"grid gap-3",children:[(a==null?void 0:a.id)&&e.jsx(it,{onPost:i=>{a!=null&&a.id&&(Ee(t.id,a.id,i,{authorName:a.username}),g(w(t.id)))}}),e.jsxs("div",{className:"grid gap-2",children:[b.length===0&&e.jsx("div",{className:"text-sm text-zinc-400/80",children:"No comments yet."}),lt(b).map(i=>e.jsx(ze,{node:i,currentUserId:(a==null?void 0:a.id)||"",ownerId:t.id,onReply:(x,p)=>{a!=null&&a.id&&(He(t.id,a.id,x,p,a.username),g(w(t.id)))},onDelete:x=>{a!=null&&a.id&&(Qe(t.id,x,a.id),g(w(t.id)))}},i.comment.id))]})]})})]})})}function at({user:s,onUpdated:t,saveProfile:r}){const[a,n]=c.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn",onClick:()=>n(!0),children:[e.jsx(Me,{size:16})," Settings"]}),a&&e.jsx(nt,{user:s,onClose:()=>n(!1),onSaved:()=>{t(),n(!1)},saveProfile:r})]})}const rt=["Founder","Early","Contributor","VIP","Designer"];function nt({user:s,onClose:t,onSaved:r,saveProfile:a}){var te,se,ae,re,ne,ie,le,oe;const[n,d]=c.useState(s.profile.avatarData||""),[m,o]=c.useState(s.profile.bannerData||""),[u,f]=c.useState(s.profile.accentFrom||"#22d3ee"),[b,g]=c.useState(s.profile.accentTo||"#8b5cf6"),[v,q]=c.useState(s.profile.bio||""),[N,$]=c.useState(s.profile.signature||""),[P,L]=c.useState(((te=s.profile.links)==null?void 0:te.website)||""),[y,D]=c.useState(((se=s.profile.links)==null?void 0:se.discord)||""),[k,F]=c.useState(((ae=s.profile.links)==null?void 0:ae.telegram)||""),[S,R]=c.useState(s.profile.badges||[]),[C,T]=c.useState(((re=s.profile.privacy)==null?void 0:re.showEmail)??!1),[I,B]=c.useState(((ne=s.profile.privacy)==null?void 0:ne.showStats)??!0),[A,_]=c.useState(((ie=s.profile.privacy)==null?void 0:ie.showLinks)??!0),[E,M]=c.useState(((le=s.profile.privacy)==null?void 0:le.allowComments)??!0),[i,x]=c.useState(((oe=s.profile.privacy)==null?void 0:oe.showFollowers)??!0),p=l=>{R(h=>h.includes(l)?h.filter(U=>U!==l):h.length>=3?h:[...h,l])},O=l=>h=>{var ce;const U=(ce=h.target.files)==null?void 0:ce[0];if(!U)return;const H=new FileReader;H.onload=()=>l(String(H.result||"")),H.readAsDataURL(U)},$e=async()=>{await a({avatarData:n||void 0,bannerData:m||void 0,accentFrom:u,accentTo:b,bio:v.trim()||void 0,signature:N.trim()||void 0,links:{website:P.trim()||void 0,discord:y.trim()||void 0,telegram:k.trim()||void 0},badges:S,privacy:{showEmail:C,showStats:I,showLinks:A,allowComments:E,showFollowers:i}}),r()};return e.jsx("div",{className:"fixed inset-0 z-[120] grid place-items-center bg-black/70 px-4 py-6",children:e.jsxs("div",{className:"card w-[min(780px,96vw)] max-h-[90vh] overflow-y-auto p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-lg font-semibold text-white",children:"Customize profile"}),e.jsx("button",{className:"btn",onClick:t,children:"Close"})]}),e.jsxs("div",{className:"mt-4 grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Avatar"}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("div",{className:"h-20 w-20 rounded-full",style:{background:n?`url(${n}) center/cover`:`linear-gradient(135deg, ${u}, ${b})`}}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"btn flex items-center gap-2",children:[e.jsx(ge,{size:16})," Upload",e.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:O(d)})]}),n&&e.jsx("button",{className:"btn",onClick:()=>d(""),children:"Remove"})]})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Banner"}),e.jsx("div",{className:"mt-3 h-20 w-full rounded-xl",style:{background:m?`url(${m}) center/cover`:`linear-gradient(135deg, ${u}, ${b})`}}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("label",{className:"btn flex items-center gap-2",children:[e.jsx(ge,{size:16})," Upload",e.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:O(o)})]}),m&&e.jsx("button",{className:"btn",onClick:()=>o(""),children:"Remove"})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Accent"}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-400/80",children:"From"}),e.jsx("input",{type:"color",value:u,onChange:l=>f(l.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-400/80",children:"To"}),e.jsx("input",{type:"color",value:b,onChange:l=>g(l.target.value)})]})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Badges (max 3)"}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:rt.map(l=>{const h=S.includes(l);return e.jsxs("button",{className:`btn flex items-center gap-2 ${h?"btn-primary":""}`,onClick:()=>p(l),type:"button",title:h?"Click to remove":"Click to add",children:[e.jsx(je,{size:16})," ",l]},l)})})]}),e.jsxs("div",{className:"card p-4 sm:col-span-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Bio"}),e.jsx("textarea",{className:"input mt-2 min-h-[120px]",value:v,onChange:l=>q(l.target.value),placeholder:"Tell the community a bit about yourself"})]}),e.jsxs("div",{className:"card p-4 sm:col-span-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Signature"}),e.jsx("textarea",{className:"input mt-2 min-h-[90px]",value:N,onChange:l=>$(l.target.value),placeholder:"Signature displayed under your posts"})]}),e.jsxs("div",{className:"card p-4 sm:col-span-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Links"}),e.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-3",children:[e.jsx("input",{className:"input",placeholder:"https://website",value:P,onChange:l=>L(l.target.value)}),e.jsx("input",{className:"input",placeholder:"discord username",value:y,onChange:l=>D(l.target.value)}),e.jsx("input",{className:"input",placeholder:"@telegram",value:k,onChange:l=>F(l.target.value)})]})]}),e.jsxs("div",{className:"card p-4 sm:col-span-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Privacy"}),e.jsxs("div",{className:"mt-3 grid gap-2 text-sm",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:l=>T(l.target.checked)})," Show email"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:I,onChange:l=>B(l.target.checked)})," Show stats"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:l=>_(l.target.checked)})," Show links"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:l=>x(l.target.checked)})," Show followers"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:l=>M(l.target.checked)})," Allow comments"]})]})]})]}),e.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[e.jsx("button",{className:"btn",onClick:t,children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:$e,children:"Save changes"})]})]})})}function it({onPost:s}){const[t,r]=c.useState("");return e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Oe,{size:16,className:"mt-1 shrink-0"}),e.jsx("textarea",{className:"input min-h-[80px] flex-1",placeholder:"Write a comment...",value:t,onChange:a=>r(a.target.value)})]}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>{const a=t.trim();a&&(s(a),r(""))},children:"Post comment"})})]})}function lt(s){const t={};s.forEach(n=>{t[n.id]={comment:n,replies:[]}});const r=[];s.forEach(n=>{const d=n.parentId||"";d&&t[d]?t[d].replies.push(t[n.id]):r.push(t[n.id])}),r.sort((n,d)=>n.comment.createdAt<d.comment.createdAt?1:-1);const a=n=>n.replies.sort((d,m)=>d.comment.createdAt>m.comment.createdAt?1:-1).forEach(a);return r.forEach(a),r}function ze({node:s,currentUserId:t,ownerId:r,onReply:a,onDelete:n}){const[d,m]=c.useState(!1),o=we(s.comment.authorId),u=s.comment.authorName||(o==null?void 0:o.username)||(s.comment.authorId===r?"Owner":s.comment.authorId===t?"You":"User");return e.jsx("div",{className:"rounded-xl border border-white/5 bg-white/3 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-8 w-8 shrink-0 rounded-full bg-gradient-to-br from-sky-500/60 to-violet-500/60"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs text-zinc-300/90",children:[o!=null&&o.username?e.jsx("a",{href:`/forum/profile/${o.username}`,className:"font-semibold text-white hover:underline",children:u}):e.jsx("span",{className:"font-semibold text-white",children:u}),e.jsxs("span",{className:"opacity-70",children:[" Â· ",new Date(s.comment.createdAt).toLocaleString()]})]}),(t===s.comment.authorId||t===r)&&e.jsx("button",{className:"btn",title:"Delete",onClick:()=>n(s.comment.id),children:e.jsx(Ue,{size:14})})]}),e.jsx("div",{className:"mt-1 whitespace-pre-wrap text-sm text-zinc-100/90",children:s.comment.content}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:e.jsx("button",{className:"btn",onClick:()=>m(f=>!f),children:"Reply"})}),d&&e.jsx("div",{className:"mt-2",children:e.jsx(ot,{onSend:f=>{a(s.comment.id,f),m(!1)}})}),s.replies.length>0&&e.jsx("div",{className:"mt-3 space-y-2 border-l border-white/10 pl-3",children:s.replies.map(f=>e.jsx(ze,{node:f,currentUserId:t,ownerId:r,onReply:a,onDelete:n},f.comment.id))})]})]})})}function ot({onSend:s}){const[t,r]=c.useState("");return e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("textarea",{className:"input min-h-[60px] flex-1",placeholder:"Write a reply...",value:t,onChange:a=>r(a.target.value)}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{const a=t.trim();a&&(s(a),r(""))},children:"Send"})]})}export{ut as default};
