import{j as r,r as I}from"./index-C8lo7uRQ.js";import{a as j,q as T,r as A,s as B,t as E,u as R}from"./icons-CWwV2OkG.js";import{R as h}from"./react-vendor-DStf8yZ1.js";const $=[{id:"lawyer",role:"Адвокат",tips:["Всегда выходи через рацию департамента: представление по форме «Адвокат Фамилия».","Перед визитом в ИК — запросить допуск и сопровождение КПП: «/d [ПР/УФСИН] Адвокат *Фамилия*. Разрешите прибыть для оказания юридической помощи заключенным ИК?»","Вход и передвижение на территории ИК — только с удостоверением и под сопровождением сотрудника ИК.","Работай в установленные окна посещений ИК","Запрещена передача денежных средств заключенным без согласования с сотрудником ФСИН"],source:"Учебные материалы: порядок работы адвоката в ИК, формы общения и запреты в рации."},{id:"inspector",role:"Инспектор",tips:["Проверки/ревизии — только с разрешения руководства и составом ≥ 2 чел.","На объекте представиться старшему, запросить режимный допуск (архив, склад, КПП).","Старт/продолжение/завершение — докладывай в /d: «/d [ПР/Орг] Инспектор Петров. Прибыл на проверку, приступаю».","Нарушения фиксируй фактами; решения — через руководителя департамента.","Плановые/внеплановые проверки — по основаниям и регламенту; итог — оценка (1–5) и доклад в /d."],source:"Порядок плановых/внеплановых проверок; инфо-раздел Правительства."},{id:"advisor",role:"Советник",tips:["Координируй собеседования и методическую помощь отделам; план согласовывай с руководством.","На совместных выездах — будь точкой коммуникации: «/d [ПР/Орг] Советник Сидоров. Координирую проверку, состав N».","В рации — только по делу, кратко, без оффтопа; спорные вопросы поднимай руководителю.","Собирай сводку и передавай руководителю департамента."]},{id:"deputy-minister",role:"Заместитель министра",tips:["Организует и принимает отчётность подразделений; назначает ответственных за связь.","Снятие судимостей — строго в здании Правительства и по регламенту, доклад в /d о факте оказания услуги.","Для гос-волны /gov: предварительно уточни в /d свободный слот и забронируй (пример ниже).","Шаблон брони гос-волны: «/d [ПР/Орг] Волна гос. новостей свободна на 18:10?», затем «Занимаю волну на 18:10»."],source:"Правила бронирования гос-волны; учебные материалы Правительства."},{id:"minister",role:"Министр",tips:["Утверждает плановые проверки/маршруты; формирует состав комиссии.","Связь: единый стандарт докладов, короткие формулы, дисциплина рации.","Совместные мероприятия с МВД/ВЧ/ЕСС согласовывает с руководителями организаций.","Итоги проверок — сводный доклад Губернатору/Вице-губернатору."]},{id:"admin-chief",role:"Глава администрации",tips:["Операционное управление аппаратом: расписания, приоритеты, контроль исполнения.","Объединяет коммуникацию департаментов при сложных кейсах.","Принимает сводные отчёты по проверкам/ревизиям и направляет резолюции.","Требует строгого соблюдения субординации и форм радиодокладов."]},{id:"vice-governor",role:"Вице-губернатор",tips:["Межведомственное взаимодействие на уровне руководителей: ФСБ/ВЧ/ЕСС/МВД.","Утверждает внеплановые проверки по установленным основаниям.","Назначает кураторов и сроки устранения нарушений; в экстренных случаях формирует единый штаб связи.","Итоги докладывает Губернатору и доводит решения до департаментов."],source:"Основания внеплановых проверок; общие регламенты взаимодействия."},{id:"governor",role:"Губернатор",tips:["Общее руководство, постановления, указы; стратегические решения.","Утверждает графики проверок и составы комиссий (не менее 3 членов для аттестаций).","Решает межведомственные споры и принимает финальные отчёты.","Награждения и меры воздействия — по итогам проверок/ревизий."],source:"Областной закон о Правительстве: порядок проверок и аттестаций."},{id:"templates-regimes",role:"Шаблоны: режимные объекты (ИК, ВЧ)",tips:["ИК (въезд/допуск): «/d [УФСИН] Должность Фамилия. Прибыл к КПП-1 ИК для [цель]. Просьба о допуске/сопровождении».","ВЧ (проезд через КПП при отсутствии дежурного): короткий доклад авто и цель въезда; дождись подтверждения и следуй указаниям КПП.","Всегда имей при себе служебное удостоверение; на территории действуй только по законным требованиям дежурного персонала."],source:"Правила КПП ВЧ, федеральный закон о режимных территориях; лекционные материалы."}];function m(e,t){return t.some(o=>e.includes(o))}function W(e){const t=e.toLowerCase();return m(t,["охран","пост","security"])?r.jsx(j,{className:"h-4 w-4"}):m(t,["адвокат","юрист","прав"])?r.jsx(T,{className:"h-4 w-4"}):m(t,["инспектор","советник","секрет","контрол"])?r.jsx(A,{className:"h-4 w-4"}):m(t,["министр","губернатор","админ","руковод"])?r.jsx(B,{className:"h-4 w-4"}):r.jsx(j,{className:"h-4 w-4"})}const f=[];var b,S,N;for(const e of I){const t=Array.isArray(e.dept)?e.dept.includes("ЮД")?"юридический":e.dept.includes("ДВД")||e.dept.includes("охрана")?"охрана":e.dept.includes("АДМ")?"админ":void 0:void 0;f.push({id:`role:${e.id}`,type:"role",title:e.role,tags:[e.role.split(" ")[0].toLowerCase(),...(((b=e.duties)==null?void 0:b.slice(0,3))||[]).map(o=>o.split(" ")[0].toLowerCase())],dept:t||"неизвестно",level:parseInt(((S=String(e.role).match(/\((\d+)\)/))==null?void 0:S[1])||"0",10),description:((N=e.duties)==null?void 0:N[0])||void 0})}var v,C;for(const e of $)f.push({id:`procedure:${e.id}`,type:"procedure",title:e.role,tags:[e.role.split(" ")[0].toLowerCase(),...(((v=e.tips)==null?void 0:v.slice(0,3))||[]).map(t=>t.split(" ")[0].toLowerCase())],dept:"админ",description:((C=e.tips)==null?void 0:C[0])||void 0});function D(e){return f.find(t=>t.id===e)}function V(e,t){if(e=e.toLowerCase(),t=t.toLowerCase(),e.includes(t))return 2;const o=new Set(e.split(/[^\p{L}\p{N}]+/u).filter(Boolean)),i=new Set(t.split(/[^\p{L}\p{N}]+/u).filter(Boolean));let n=0;for(const c of i)o.has(c)&&n++;return n>0?1:0}function z(e,t=6){const o=s=>e.dept&&s?e.dept===s:!0,i=new Set((e.tags||[]).map(s=>s.toLowerCase()));function n(s){if(s.id===e.id)return-1;let a=0;o(s.dept)&&(a+=2);const p=(s.tags||[]).reduce((u,k)=>u+(i.has(String(k).toLowerCase())?1:0),0);return a+=Math.min(p,3),a+=V(s.title,e.title),a}const c=f.filter(s=>s.type!==e.type).map(s=>({m:s,s:n(s)})).filter(s=>s.s>0).sort((s,a)=>a.s-s.s).slice(0,t*2).map(s=>s.m),l={procedures:[],templates:[],roles:[]};for(const s of c)s.type==="procedure"&&l.procedures.length<t?l.procedures.push(s):s.type==="template"&&l.templates.length<t?l.templates.push(s):s.type==="role"&&l.roles.length<t&&l.roles.push(s);return l}function g({title:e,items:t}){return t.length?r.jsxs("div",{className:"mt-2 text-xs",children:[r.jsx("div",{className:"mb-1 font-semibold opacity-70",children:e}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:t.slice(0,6).map(o=>r.jsx("span",{title:o.description||o.title,className:"inline-flex max-w-[14rem] items-center gap-1 truncate rounded-full border px-2 py-0.5 hover:bg-zinc-100 dark:hover:bg-zinc-800",children:r.jsx("span",{className:"truncate",children:o.title})},o.id))})]}):null}function H({itemId:e,itemType:t}){const o=D(e);if(!o)return r.jsx("div",{className:"mt-2 text-xs italic opacity-60",children:"Пока без связей"});const i=z(o),n=i.procedures.length+i.templates.length+i.roles.length;return r.jsxs("div",{className:"mt-3 rounded-xl border border-zinc-200 p-2 dark:border-zinc-800",children:[r.jsxs("div",{className:"mb-1 text-xs font-semibold",children:["Связано с этим: ",n]}),r.jsx(g,{title:"Процедуры",items:i.procedures}),r.jsx(g,{title:"Шаблоны",items:i.templates}),r.jsx(g,{title:"Роли",items:i.roles}),!n&&r.jsx("div",{className:"text-xs opacity-60",children:"Пока без связей"})]})}const d={},L=(d==null?void 0:d.VITE_VOTE_API_BASE)||(d==null?void 0:d.VITE_API_BASE)||"https://sky-api.wizardiowhy.workers.dev",x=new Set;let w=null;const y=new Map;function U(e,t){y.set(e,t)}function O(e){y.delete(e)}function P(e){x.add(e),!w&&(w=setTimeout(async()=>{var t;try{const o=[...x];x.clear(),w=null;const n=await(await fetch(`${L}/api/stats?ids=${encodeURIComponent(o.join(","))}`)).json(),c=(n==null?void 0:n.stats)||{};for(const[l,s]of Object.entries(c))(t=y.get(l))==null||t(s)}catch{}},120))}function F(){const e="anon_uid";let t=localStorage.getItem(e);return t||(t=crypto.randomUUID(),localStorage.setItem(e,t)),t}async function M(e,t){if(localStorage.getItem("telemetry_disabled")==="1")return null;const o=`voted:${e}`;if(localStorage.getItem(o))return null;localStorage.setItem(o,"1");try{const n=await(await fetch(`${L}/api/vote`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({card_id:e,vote:t,anon_uid:F()})})).json();if(n!=null&&n.ok&&n.totals)return n.totals}catch{}return null}function K({cardId:e}){const[t,o]=h.useState({up:0,down:0}),[i,n]=h.useState(!1),c=typeof window<"u"&&!!localStorage.getItem(`voted:${e}`),l=i||c||localStorage.getItem("telemetry_disabled")==="1";h.useEffect(()=>(P(e),U(e,o),()=>O(e)),[e]);async function s(a){if(l)return;n(!0),o(u=>({up:u.up+(a===1?1:0),down:u.down+(a===-1?1:0)}));const p=await M(e,a);p&&o(p),n(!1)}return localStorage.getItem("telemetry_disabled")==="1"?null:r.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs",children:[r.jsxs("button",{className:"btn",onClick:()=>s(1),disabled:l,children:[r.jsx(E,{className:"h-4 w-4"})," ",t.up]}),r.jsxs("button",{className:"btn",onClick:()=>s(-1),disabled:l,children:[r.jsx(R,{className:"h-4 w-4"})," ",t.down]})]})}export{H as R,K as V,$ as a,W as i};
