function u(){try{const o=new URL(window.location.href),e=o.searchParams.get("api");if(e){localStorage.setItem("forum:api_base",e);try{o.searchParams.delete("api"),history.replaceState({},"",o.toString())}catch{}}const c=localStorage.getItem("forum:api_base");if(c)return c}catch{}return"https://notifications-worker.wizardiowhy.workers.dev/skyapi"}const p=u(),r="forum:token";function y(){try{return localStorage.getItem(r)??sessionStorage.getItem(r)}catch{return null}}async function n(t,o={}){const e=y(),c={"Content-Type":"application/json",...o.headers||{}};e&&(c.Authorization=`Bearer ${e}`);const i=await fetch(`${p}${t}`,{...o,headers:c}),a=await i.text();let s={};try{s=a?JSON.parse(a):{}}catch{s={error:a||i.statusText}}if(!i.ok)throw new Error((s==null?void 0:s.error)||`${i.status} ${i.statusText}`);return s}async function d(){const{sections:t}=await n("/sections");return t}async function f(t){const{section:o}=await n("/sections",{method:"POST",body:JSON.stringify(t)});return o}async function m(t,o){const{section:e}=await n(`/sections/${t}`,{method:"PATCH",body:JSON.stringify(o)});return e}async function h(t){await n(`/sections/${encodeURIComponent(t)}`,{method:"DELETE"})}async function w(t){const o=t?`?sectionId=${encodeURIComponent(t)}`:"",{topics:e}=await n(`/topics${o}`);return e}async function l(t){const{topic:o}=await n("/topics",{method:"POST",body:JSON.stringify(t)});return o}async function S(t,o){const{topic:e}=await n(`/topics/${t}`,{method:"PATCH",body:JSON.stringify(o)});return e}async function T(t){try{const{topic:o}=await n(`/topics/${t}`);return o}catch{return null}}async function g(t,o){const{topic:e}=await n(`/topics/${t}/move`,{method:"POST",body:JSON.stringify({to:o})});return e}async function $(t){await n(`/topics/${encodeURIComponent(t)}`,{method:"DELETE"})}async function P(t){const{posts:o}=await n(`/posts?topicId=${encodeURIComponent(t)}`);return o}async function O(t){const{post:o}=await n("/posts",{method:"POST",body:JSON.stringify(t)});return o}async function E(t,o){const{post:e}=await n(`/posts/${t}`,{method:"PATCH",body:JSON.stringify(o)});return e}async function I(t){await n(`/posts/${encodeURIComponent(t)}`,{method:"DELETE"})}async function C(t){const{post:o}=await n(`/posts/${encodeURIComponent(t)}/like`,{method:"POST"});return o}async function b(t=8){const{posts:o}=await n(`/latest-posts?limit=${t}`);return o}async function k(){await n("/maintenance/reset",{method:"POST"})}export{O as createPost,f as createSection,l as createTopic,I as deletePost,h as deleteSection,$ as deleteTopic,T as getTopic,b as listLatestPosts,P as listPosts,d as listSections,w as listTopics,g as moveTopic,k as resetForum,C as toggleLikePost,E as updatePost,m as updateSection,S as updateTopic};
