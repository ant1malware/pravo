function u(){try{const o=new URL(window.location.href),n=o.searchParams.get("api");if(n){localStorage.setItem("forum:api_base",n);try{o.searchParams.delete("api"),history.replaceState({},"",o.toString())}catch{}}const a=localStorage.getItem("forum:api_base");if(a)return a}catch{}return"https://notifications-worker.wizardiowhy.workers.dev/skyapi"}const p=u(),r="forum:token";function y(){try{return localStorage.getItem(r)??sessionStorage.getItem(r)}catch{return null}}async function s(t,o={}){const n=y(),a={"Content-Type":"application/json",...o.headers||{}};n&&(a.Authorization=`Bearer ${n}`);const c=await fetch(`${p}${t}`,{...o,headers:a}),i=await c.text();let e={};try{e=i?JSON.parse(i):{}}catch{e={error:i||c.statusText}}if(!c.ok)throw new Error((e==null?void 0:e.error)||`${c.status} ${c.statusText}`);return e}async function d(){const{sections:t}=await s("/sections");return t}async function f(t){const{section:o}=await s("/sections",{method:"POST",body:JSON.stringify(t)});return o}async function m(t,o){const{section:n}=await s(`/sections/${t}`,{method:"PATCH",body:JSON.stringify(o)});return n}async function h(t){await s(`/sections/${encodeURIComponent(t)}`,{method:"DELETE"})}async function w(t){const o=t?`?sectionId=${encodeURIComponent(t)}`:"",{topics:n}=await s(`/topics${o}`);return n}async function l(t){const{topic:o}=await s("/topics",{method:"POST",body:JSON.stringify(t)});return o}async function S(t,o){const{topic:n}=await s(`/topics/${t}`,{method:"PATCH",body:JSON.stringify(o)});return n}async function T(t,o){const{topic:n}=await s(`/topics/${t}/move`,{method:"POST",body:JSON.stringify({to:o})});return n}async function g(t){await s(`/topics/${encodeURIComponent(t)}`,{method:"DELETE"})}async function $(t){const{posts:o}=await s(`/posts?topicId=${encodeURIComponent(t)}`);return o}async function P(t){const{post:o}=await s("/posts",{method:"POST",body:JSON.stringify(t)});return o}async function E(t,o){const{post:n}=await s(`/posts/${t}`,{method:"PATCH",body:JSON.stringify(o)});return n}async function O(t){await s(`/posts/${encodeURIComponent(t)}`,{method:"DELETE"})}async function b(t=8){const{posts:o}=await s(`/latest-posts?limit=${t}`);return o}export{b as a,w as b,l as c,O as d,$ as e,P as f,E as g,f as h,m as i,h as j,g as k,d as l,T as m,S as u};
