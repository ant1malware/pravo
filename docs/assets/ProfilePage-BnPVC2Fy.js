import{j as e}from"./index-C4sM7TPz.js";import{u as J,R as r}from"./react-vendor-DTkXckhQ.js";import{g as T,e as R,f as F,a as U,u as W,h as Y}from"./authRemote-CAdjfFcm.js";import{a0 as q,a1 as I,a2 as H,a3 as O,a4 as K}from"./icons-CVylmSus.js";const Q={developer:{label:"Developer",color:"#22d3ee"},admin:{label:"Admin",color:"#ef4444"},moderator:{label:"Moderator",color:"#8b5cf6"},vip:{label:"VIP",color:"#eab308"},user:{label:"User",color:"#94a3b8"},newbie:{label:"Newbie",color:"#22d3ee"}},X=["Founder","Early","Contributor","VIP","Designer"];function Z({role:a}){const s=Q[a]||{label:a,color:"#94a3b8"};return e.jsx("span",{className:"rounded-full border border-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.26em]",style:{color:s.color},children:s.label})}function z({value:a,label:s}){return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-extrabold text-white",children:a}),e.jsx("div",{className:"mt-1 text-xs uppercase tracking-[0.3em] text-zinc-400/80",children:s})]})}function C({title:a,children:s}){return e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"mb-2 text-xs uppercase tracking-[0.28em] text-zinc-400/70",children:a}),s]})}function ne(){var p,b,g,N,h,k;const{username:a=""}=J(),[s,d]=r.useState(null),[m,l]=r.useState(null),[f,x]=r.useState(!1);if(r.useEffect(()=>{(async()=>{try{const c=await T();if(c){x(!0),l({id:c.id,username:c.username});const n=await R(a);if(n){const y={id:n.user.id,username:n.user.username,email:n.user.email,createdAt:n.user.createdAt,role:n.user.role,userNumber:n.user.userNumber,posts:0,likes:0,topics:0,profile:n.profile||{bio:"",signature:"",links:{},accentFrom:"#8b5cf6",accentTo:"#0ea5e9",badges:[],privacy:{showEmail:!1,showStats:!0}},bans:null,mutes:null};d(y);return}}}catch{}x(!1),d(F(a)||null);const i=U();l(i?{id:i.id,username:i.username}:null)})()},[a]),r.useEffect(()=>{const i=async()=>{try{const n=await T();if(n){l({id:n.id,username:n.username});return}}catch{}const c=U();l(c?{id:c.id,username:c.username}:null)};return window.addEventListener("forum:session",i),window.addEventListener("storage",i),()=>{window.removeEventListener("forum:session",i),window.removeEventListener("storage",i)}},[]),!s)return e.jsx("main",{className:"min-h-screen bg-slate-950 text-slate-200",children:e.jsx("div",{className:"mx-auto max-w-3xl px-4 py-12",children:e.jsx("div",{className:"card p-6 text-center text-sm text-zinc-300",children:"Profile not found."})})});const v=(m==null?void 0:m.id)===s.id,u=s.profile.accentFrom||"#22d3ee",j=s.profile.accentTo||"#8b5cf6";return e.jsx("main",{className:"min-h-screen",style:{background:"radial-gradient(900px 600px at 20% -10%, rgba(59,130,246,0.18), transparent 65%), radial-gradient(1100px 760px at 95% 8%, rgba(236,72,153,0.16), transparent 68%), #0d0d12",color:"#f8fafc"},children:e.jsxs("div",{className:"mx-auto max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{style:{height:180,background:s.profile.bannerData?`url(${s.profile.bannerData}) center/cover`:`linear-gradient(135deg, ${u}, ${j})`}}),e.jsxs("div",{className:"flex flex-wrap items-end gap-4 px-4 pb-4 -mt-16",children:[e.jsx("div",{className:"h-24 w-24 rounded-full ring-4 ring-[rgba(13,19,33,0.85)]",style:{background:s.profile.avatarData?`url(${s.profile.avatarData}) center/cover`:`linear-gradient(135deg, ${u}, ${j})`}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-extrabold text-white",children:s.username}),e.jsx(Z,{role:s.role}),e.jsxs("span",{className:"text-xs text-zinc-400/80",children:["#",s.userNumber]})]}),e.jsxs("div",{className:"mt-1 text-xs text-zinc-500",children:["Joined ",new Date(s.createdAt).toLocaleDateString()]})]}),v&&e.jsx(ee,{user:s,onUpdated:async()=>{if(f){const i=await R(a);i&&d({id:i.user.id,username:i.user.username,email:i.user.email,createdAt:i.user.createdAt,role:i.user.role,userNumber:i.user.userNumber,posts:0,likes:0,topics:0,profile:i.profile,bans:null,mutes:null})}else d(F(a)||null)},saveProfile:async i=>{f?await W(i):Y(s.id,i)}})]})]}),e.jsxs("div",{className:"mt-6 grid gap-4 sm:grid-cols-3",children:[e.jsx(z,{value:s.posts,label:"Posts"}),e.jsx(z,{value:s.topics,label:"Topics"}),e.jsx(z,{value:s.likes,label:"Likes"})]}),e.jsxs("div",{className:"mt-6 grid gap-4 lg:grid-cols-[1.35fr_.85fr]",children:[e.jsx(C,{title:"About",children:e.jsx("p",{className:"whitespace-pre-wrap text-sm text-zinc-200/80",children:s.profile.bio||"No bio yet."})}),e.jsx(C,{title:"Links",children:e.jsxs("div",{className:"grid gap-2 text-sm text-zinc-200/80",children:[(p=s.profile.links)!=null&&p.website?e.jsxs("a",{className:"flex items-center gap-2 text-sky-300 hover:text-sky-200",href:s.profile.links.website,target:"_blank",rel:"noreferrer",children:[e.jsx(q,{size:14}),s.profile.links.website]}):null,(b=s.profile.links)!=null&&b.discord?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{size:14})," Discord: ",s.profile.links.discord]}):null,(g=s.profile.links)!=null&&g.telegram?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{size:14})," Telegram: ",s.profile.links.telegram]}):null,!((N=s.profile.links)!=null&&N.website)&&!((h=s.profile.links)!=null&&h.discord)&&!((k=s.profile.links)!=null&&k.telegram)&&e.jsx("span",{children:"No links added."})]})})]}),e.jsx(C,{title:"Signature",children:e.jsx("div",{className:"whitespace-pre-wrap text-sm text-zinc-200/80",children:s.profile.signature||"No signature."})})]})})}function ee({user:a,onUpdated:s,saveProfile:d}){const[m,l]=r.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn",onClick:()=>l(!0),children:[e.jsx(H,{size:16})," Customize"]}),m&&e.jsx(se,{user:a,onClose:()=>l(!1),onSaved:()=>{s(),l(!1)},saveProfile:d})]})}function se({user:a,onClose:s,onSaved:d,saveProfile:m}){var $,B,E;const[l,f]=r.useState(a.profile.avatarData||""),[x,v]=r.useState(a.profile.bannerData||""),[u,j]=r.useState(a.profile.accentFrom||"#22d3ee"),[p,b]=r.useState(a.profile.accentTo||"#8b5cf6"),[g,N]=r.useState(a.profile.bio||""),[h,k]=r.useState(a.profile.signature||""),[i,c]=r.useState((($=a.profile.links)==null?void 0:$.website)||""),[n,y]=r.useState(((B=a.profile.links)==null?void 0:B.discord)||""),[A,_]=r.useState(((E=a.profile.links)==null?void 0:E.telegram)||""),[D,M]=r.useState(a.profile.badges||[]),G=t=>{M(o=>o.includes(t)?o.filter(w=>w!==t):o.length>=3?o:[...o,t])},L=t=>o=>{var P;const w=(P=o.target.files)==null?void 0:P[0];if(!w)return;const S=new FileReader;S.onload=()=>t(String(S.result||"")),S.readAsDataURL(w)},V=async()=>{await m({avatarData:l||void 0,bannerData:x||void 0,accentFrom:u,accentTo:p,bio:g.trim()||void 0,signature:h.trim()||void 0,links:{website:i.trim()||void 0,discord:n.trim()||void 0,telegram:A.trim()||void 0},badges:D}),d()};return e.jsx("div",{className:"fixed inset-0 z-[120] grid place-items-center bg-black/70 px-4 py-6",children:e.jsxs("div",{className:"card w-[min(780px,96vw)] max-h-[90vh] overflow-y-auto p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-lg font-semibold text-white",children:"Customize profile"}),e.jsx("button",{className:"btn",onClick:s,children:"Close"})]}),e.jsxs("div",{className:"mt-4 grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Avatar"}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("div",{className:"h-20 w-20 rounded-full",style:{background:l?`url(${l}) center/cover`:`linear-gradient(135deg, ${u}, ${p})`}}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"btn flex items-center gap-2",children:[e.jsx(O,{size:16}),"Upload",e.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:L(f)})]}),l&&e.jsx("button",{className:"btn",onClick:()=>f(""),children:"Remove"})]})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Banner"}),e.jsx("div",{className:"mt-3 h-20 w-full rounded-xl",style:{background:x?`url(${x}) center/cover`:`linear-gradient(135deg, ${u}, ${p})`}}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("label",{className:"btn flex items-center gap-2",children:[e.jsx(O,{size:16}),"Upload",e.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:L(v)})]}),x&&e.jsx("button",{className:"btn",onClick:()=>v(""),children:"Remove"})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Accent"}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-400/80",children:"From"}),e.jsx("input",{type:"color",value:u,onChange:t=>j(t.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-400/80",children:"To"}),e.jsx("input",{type:"color",value:p,onChange:t=>b(t.target.value)})]})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Badges (max 3)"}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:X.map(t=>{const o=D.includes(t);return e.jsxs("button",{className:`btn flex items-center gap-2 ${o?"btn-primary":""}`,onClick:()=>G(t),type:"button",children:[e.jsx(K,{size:16})," ",t]},t)})})]}),e.jsxs("div",{className:"card p-4 sm:col-span-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Bio"}),e.jsx("textarea",{className:"input mt-2 min-h-[120px]",value:g,onChange:t=>N(t.target.value),placeholder:"Tell the community a bit about yourself"})]}),e.jsxs("div",{className:"card p-4 sm:col-span-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Signature"}),e.jsx("textarea",{className:"input mt-2 min-h-[90px]",value:h,onChange:t=>k(t.target.value),placeholder:"Signature displayed under your posts"})]}),e.jsxs("div",{className:"card p-4 sm:col-span-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Links"}),e.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-3",children:[e.jsx("input",{className:"input",placeholder:"https://website",value:i,onChange:t=>c(t.target.value)}),e.jsx("input",{className:"input",placeholder:"discord username",value:n,onChange:t=>y(t.target.value)}),e.jsx("input",{className:"input",placeholder:"@telegram",value:A,onChange:t=>_(t.target.value)})]})]})]}),e.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[e.jsx("button",{className:"btn",onClick:s,children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:V,children:"Save changes"})]})]})})}export{ne as default};
