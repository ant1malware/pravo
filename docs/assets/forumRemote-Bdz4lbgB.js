function u(){try{const o=new URL(window.location.href),n=o.searchParams.get("api");if(n){localStorage.setItem("forum:api_base",n);try{o.searchParams.delete("api"),history.replaceState({},"",o.toString())}catch{}}const a=localStorage.getItem("forum:api_base");if(a)return a}catch{}return"https://notifications-worker.wizardiowhy.workers.dev/skyapi"}const p=u(),r="forum:token";function y(){try{return localStorage.getItem(r)??sessionStorage.getItem(r)}catch{return null}}async function e(t,o={}){const n=y(),a={"Content-Type":"application/json",...o.headers||{}};n&&(a.Authorization=`Bearer ${n}`);const c=await fetch(`${p}${t}`,{...o,headers:a}),i=await c.text();let s={};try{s=i?JSON.parse(i):{}}catch{s={error:i||c.statusText}}if(!c.ok)throw new Error((s==null?void 0:s.error)||`${c.status} ${c.statusText}`);return s}async function f(){const{sections:t}=await e("/sections");return t}async function d(t){const{section:o}=await e("/sections",{method:"POST",body:JSON.stringify(t)});return o}async function m(t,o){const{section:n}=await e(`/sections/${t}`,{method:"PATCH",body:JSON.stringify(o)});return n}async function h(t){await e(`/sections/${encodeURIComponent(t)}`,{method:"DELETE"})}async function l(t){const o=t?`?sectionId=${encodeURIComponent(t)}`:"",{topics:n}=await e(`/topics${o}`);return n}async function w(t){const{topic:o}=await e("/topics",{method:"POST",body:JSON.stringify(t)});return o}async function S(t,o){const{topic:n}=await e(`/topics/${t}`,{method:"PATCH",body:JSON.stringify(o)});return n}async function T(t,o){const{topic:n}=await e(`/topics/${t}/move`,{method:"POST",body:JSON.stringify({to:o})});return n}async function g(t){await e(`/topics/${encodeURIComponent(t)}`,{method:"DELETE"})}async function $(t){const{posts:o}=await e(`/posts?topicId=${encodeURIComponent(t)}`);return o}async function O(t){const{post:o}=await e("/posts",{method:"POST",body:JSON.stringify(t)});return o}async function P(t=8){const{posts:o}=await e(`/latest-posts?limit=${t}`);return o}export{P as a,l as b,w as c,$ as d,O as e,d as f,m as g,h,g as i,f as l,T as m,S as u};
