function u(){try{const o=new URL(window.location.href),e=o.searchParams.get("api");if(e){localStorage.setItem("forum:api_base",e);try{o.searchParams.delete("api"),history.replaceState({},"",o.toString())}catch{}}const a=localStorage.getItem("forum:api_base");if(a)return a}catch{}return"https://notifications-worker.wizardiowhy.workers.dev/skyapi"}const p=u(),r="forum:token";function f(){try{return localStorage.getItem(r)??sessionStorage.getItem(r)}catch{return null}}async function n(t,o={}){const e=f(),a={"Content-Type":"application/json",...o.headers||{}};e&&(a.Authorization=`Bearer ${e}`);const c=await fetch(`${p}${t}`,{...o,headers:a}),i=await c.text();let s={};try{s=i?JSON.parse(i):{}}catch{s={error:i||c.statusText}}if(!c.ok)throw new Error((s==null?void 0:s.error)||`${c.status} ${c.statusText}`);return s}async function y(){const{sections:t}=await n("/sections");return t}async function d(t){const{section:o}=await n("/sections",{method:"POST",body:JSON.stringify(t)});return o}async function m(t,o){const{section:e}=await n(`/sections/${t}`,{method:"PATCH",body:JSON.stringify(o)});return e}async function h(t){await n(`/sections/${encodeURIComponent(t)}`,{method:"DELETE"})}async function l(t){const o=t?`?sectionId=${encodeURIComponent(t)}`:"",{topics:e}=await n(`/topics${o}`);return e}async function w(t){const{topic:o}=await n("/topics",{method:"POST",body:JSON.stringify(t)});return o}async function S(t,o){const{topic:e}=await n(`/topics/${t}`,{method:"PATCH",body:JSON.stringify(o)});return e}async function T(t,o){const{topic:e}=await n(`/topics/${t}/move`,{method:"POST",body:JSON.stringify({to:o})});return e}async function g(t){await n(`/topics/${encodeURIComponent(t)}`,{method:"DELETE"})}async function $(t=8){const{posts:o}=await n(`/latest-posts?limit=${t}`);return o}export{$ as a,l as b,w as c,d,h as e,S as f,g,y as l,T as m,m as u};
