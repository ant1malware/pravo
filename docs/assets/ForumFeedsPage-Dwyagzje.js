import{j as e}from"./index-D3wRyfie.js";import{b as l,R as i,L as d}from"./react-vendor-DTkXckhQ.js";import{g as u,F as f}from"./ForumSubnav-DUPJ4zul.js";import{F as x}from"./ForumSearch-BZvQ1SX3.js";import{listTopics as p}from"./forumRemote-D5s3MT8n.js";import{s as h}from"./seo-CUoHaANs.js";import"./icons-DvR9fjIV.js";function C(){const o=l(),a=new URLSearchParams(o.search||"").get("feed"),[r,t]=i.useState(a||u()),[s,c]=i.useState([]);return i.useEffect(()=>{try{h("Ленты — Форум","Горячее, новое и вопросы форума")}catch{}},[]),i.useEffect(()=>{let n=!0;return(async()=>{try{const m=await p();n&&c(m||[])}catch{n&&c([])}})(),()=>{n=!1}},[]),i.useEffect(()=>{a&&t(a)},[a]),e.jsx("main",{className:"min-h-screen",style:{background:"#0d0d12",color:"#f8fafc"},children:e.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-6",children:[e.jsx(f,{}),e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx("button",{className:`tab ${r==="hot"?"tab-active":""}`,onClick:()=>t("hot"),children:"Горячее"}),e.jsx("button",{className:`tab ${r==="new"?"tab-active":""}`,onClick:()=>t("new"),children:"Новое"}),e.jsx(d,{className:"tab",to:"/forum/questions",children:"Вопросы"})]}),e.jsx(x,{}),e.jsx("div",{className:"mt-4",children:e.jsx(j,{feed:r,topics:s})})]})})}function j({feed:o,topics:a}){const r=i.useMemo(()=>{const t=(a||[]).slice();return o==="new"?t.sort((s,c)=>new Date(c.createdAt).getTime()-new Date(s.createdAt).getTime()).slice(0,20):t.map(s=>({t:s,s:(s.replyCount||0)*2+(s.viewCount||0)*.1-Math.max(0,(Date.now()-new Date(s.updatedAt).getTime())/36e5)*.02})).sort((s,c)=>c.s-s.s).slice(0,20).map(s=>s.t)},[o,a]);return r.length===0?e.jsx("div",{className:"card p-4 text-sm opacity-70",children:"Лента пуста."}):e.jsx("div",{className:"grid gap-3",children:r.map(t=>e.jsxs("a",{href:`/forum/topic/${t.id}`,className:"block rounded-xl border border-white/10 bg-white/[0.04] p-3",children:[e.jsx("div",{className:"font-semibold truncate",children:t.title}),e.jsxs("div",{className:"mt-1 text-xs opacity-70",children:["Ответов ",t.replyCount," • Просмотры ",t.viewCount," • Обновлено ",new Date(t.updatedAt).toLocaleString()]})]},t.id))})}export{C as default};
