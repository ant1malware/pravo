import{j as s}from"./index-SvquseAp.js";import{b as N,R as l,L as x}from"./react-vendor-DTkXckhQ.js";import{listSections as $}from"./forumRemote-D5s3MT8n.js";import{ao as B,a2 as U,U as W,an as z}from"./icons-wEjUy8Cq.js";const I=["latest","hot","new","following","unanswered","unread","questions"],k="forum:default_feed";function y(t){return typeof t=="string"&&I.includes(t)}function P(){try{const t=localStorage.getItem(k);if(y(t))return t}catch{}return"latest"}function R(t){if(y(t))try{localStorage.setItem(k,t)}catch{}}const A="app:lang";function M(){try{const t=localStorage.getItem(A);if(t==="ru"||t==="en")return t}catch{}return"ru"}function o(t,r){return M()==="ru"?t:r}function _(){const t=N(),[r,f]=l.useState(null);l.useEffect(()=>{let e=!0;return(async()=>{try{const n=(await $()||[]).find(a=>String(a.title||"").toLowerCase()==="workshop");e&&f((n==null?void 0:n.id)||null)}catch{e&&f(null)}})(),()=>{e=!1}},[]);const p=t.pathname.includes("/forum/members"),h=r?t.pathname.startsWith(`/forum/section/${r}`):!1,w=!p&&!h,F=new URLSearchParams(t.search||"").get("feed"),j=P(),i=F||j,m=({to:e,active:u,icon:n,children:a,disabled:C,title:g})=>C?s.jsxs("span",{className:`btn inline-flex items-center gap-2 ${u?"btn-primary":""} opacity-60 cursor-not-allowed`,title:g||"","aria-disabled":!0,children:[n," ",a]}):s.jsxs(x,{to:e,className:`btn inline-flex items-center gap-2 ${u?"btn-primary":""}`,title:g||"",children:[n," ",a]}),[E,d]=l.useState(!1);l.useEffect(()=>{const e=()=>d(!1);return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);const b=[{key:"latest",label:o("\u0421\u0432\u0435\u0436\u0438\u0435","Latest")},{key:"hot",label:o("\u0422\u043E\u043F","Hot")},{key:"new",label:o("\u041D\u043E\u0432\u044B\u0435","New")},{key:"following",label:o("\u041F\u043E\u0434\u043F\u0438\u0441\u043A\u0438","Following")}],v=e=>{var u;return((u=b.find(n=>n.key===e))==null?void 0:u.label)||o("\u041B\u0435\u043D\u0442\u0430","Feed")},c=(e,u)=>{const n=new URLSearchParams(t.search);u?n.set("feed",u):n.delete("feed");const a=n.toString();return`${e}${a?`?${a}`:""}`},S=c("/forum",i),D=c("/forum/members",null),L=r?c(`/forum/section/${r}`,null):"#";return s.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[s.jsx(m,{to:S,active:w,icon:s.jsx(B,{size:16}),children:o("\u0424\u043E\u0440\u0443\u043C","Forums")}),s.jsx(m,{to:L,active:h,disabled:!r,icon:s.jsx(U,{size:16}),title:r?"":o("\u0420\u0430\u0437\u0434\u0435\u043B Workshop \u0435\u0449\u0451 \u043D\u0435 \u0441\u043E\u0437\u0434\u0430\u043D","Workshop section is not created yet"),children:o("\u041C\u0430\u0441\u0442\u0435\u0440\u0441\u043A\u0430\u044F","Workshop")}),s.jsx(m,{to:D,active:p,icon:s.jsx(W,{size:16}),children:o("\u0423\u0447\u0430\u0441\u0442\u043D\u0438\u043A\u0438","Members")}),s.jsxs("div",{className:"relative ml-auto",onClick:e=>e.stopPropagation(),"aria-label":o("\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043B\u0435\u043D\u0442\u0443","Choose feed"),children:[s.jsxs("button",{type:"button",className:"btn inline-flex items-center gap-2",onClick:()=>d(e=>!e),children:[s.jsx("span",{className:"truncate max-w-[10rem]",children:v(i)}),s.jsx(z,{size:16})]}),E&&s.jsx("div",{className:"absolute right-0 z-20 mt-2 min-w-40 rounded-xl border bg-background p-2 shadow-lg",children:b.map(e=>{const u=c("/forum",e.key),n=i===e.key;return s.jsx(x,{to:u,className:`block rounded-md px-3 py-2 text-sm hover:bg-muted ${n?"font-semibold":""}`,onClick:()=>{try{R(e.key)}catch{}d(!1)},children:e.label},String(e.key))})})]})]})}export{_ as F,P as g,o as t};
