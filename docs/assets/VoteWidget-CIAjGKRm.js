import{j as o,a as R}from"./index-CqvaTg_U.js";import{S as v,J as D,N as V,O as z,V as E,W as I}from"./icons-GyIOUIPt.js";import{R as m}from"./react-vendor-DTkXckhQ.js";const O=[{id:"lawyer",role:"Адвокат",tips:["Всегда выходи через рацию департамента: представление по форме «Адвокат Фамилия».","Перед визитом в ИК — запросить допуск и сопровождение КПП: «/d [ПР/УФСИН] Адвокат *Фамилия*. Разрешите прибыть для оказания юридической помощи заключенным ИК?»","Вход и передвижение на территории ИК — только с удостоверением и под сопровождением сотрудника ИК.","Работай в установленные окна посещений ИК","Запрещена передача денежных средств заключенным без согласования с сотрудником ФСИН"],source:"Учебные материалы: порядок работы адвоката в ИК, формы общения и запреты в рации."},{id:"inspector",role:"Инспектор",tips:["Проверки/ревизии — только с разрешения руководства и составом ≥ 2 чел.","На объекте представиться старшему, запросить режимный допуск (архив, склад, КПП).","Старт/продолжение/завершение — докладывай в /d: «/d [ПР/Орг] Инспектор Петров. Прибыл на проверку, приступаю».","Нарушения фиксируй фактами; решения — через руководителя департамента.","Плановые/внеплановые проверки — по основаниям и регламенту; итог — оценка (1–5) и доклад в /d."],source:"Порядок плановых/внеплановых проверок; инфо-раздел Правительства."},{id:"advisor",role:"Советник",tips:["Координируй собеседования и методическую помощь отделам; план согласовывай с руководством.","На совместных выездах — будь точкой коммуникации: «/d [ПР/Орг] Советник Сидоров. Координирую проверку, состав N».","В рации — только по делу, кратко, без оффтопа; спорные вопросы поднимай руководителю.","Собирай сводку и передавай руководителю департамента."]},{id:"deputy-minister",role:"Заместитель министра",tips:["Организует и принимает отчётность подразделений; назначает ответственных за связь.","Снятие судимостей — строго в здании Правительства и по регламенту, доклад в /d о факте оказания услуги.","Для гос-волны /gov: предварительно уточни в /d свободный слот и забронируй (пример ниже).","Шаблон брони гос-волны: «/d [ПР/Орг] Волна гос. новостей свободна на 18:10?», затем «Занимаю волну на 18:10»."],source:"Правила бронирования гос-волны; учебные материалы Правительства."},{id:"minister",role:"Министр",tips:["Утверждает плановые проверки/маршруты; формирует состав комиссии.","Связь: единый стандарт докладов, короткие формулы, дисциплина рации.","Совместные мероприятия с МВД/ВЧ/ЕСС согласовывает с руководителями организаций.","Итоги проверок — сводный доклад Губернатору/Вице-губернатору."]},{id:"admin-chief",role:"Глава администрации",tips:["Операционное управление аппаратом: расписания, приоритеты, контроль исполнения.","Объединяет коммуникацию департаментов при сложных кейсах.","Принимает сводные отчёты по проверкам/ревизиям и направляет резолюции.","Требует строгого соблюдения субординации и форм радиодокладов."]},{id:"vice-governor",role:"Вице-губернатор",tips:["Межведомственное взаимодействие на уровне руководителей: ФСБ/ВЧ/ЕСС/МВД.","Утверждает внеплановые проверки по установленным основаниям.","Назначает кураторов и сроки устранения нарушений; в экстренных случаях формирует единый штаб связи.","Итоги докладывает Губернатору и доводит решения до департаментов."],source:"Основания внеплановых проверок; общие регламенты взаимодействия."},{id:"governor",role:"Губернатор",tips:["Общее руководство, постановления, указы; стратегические решения.","Утверждает графики проверок и составы комиссий (не менее 3 членов для аттестаций).","Решает межведомственные споры и принимает финальные отчёты.","Награждения и меры воздействия — по итогам проверок/ревизий."],source:"Областной закон о Правительстве: порядок проверок и аттестаций."},{id:"templates-regimes",role:"Шаблоны: режимные объекты (ИК, ВЧ)",tips:["ИК (въезд/допуск): «/d [УФСИН] Должность Фамилия. Прибыл к КПП-1 ИК для [цель]. Просьба о допуске/сопровождении».","ВЧ (проезд через КПП при отсутствии дежурного): короткий доклад авто и цель въезда; дождись подтверждения и следуй указаниям КПП.","Всегда имей при себе служебное удостоверение; на территории действуй только по законным требованиям дежурного персонала."],source:"Правила КПП ВЧ, федеральный закон о режимных территориях; лекционные материалы."}];function p(e,t){return t.some(n=>e.includes(n))}function Q(e){const t=e.toLowerCase();return p(t,["охран","пост","security"])?o.jsx(v,{className:"h-4 w-4"}):p(t,["адвокат","юрист","прав"])?o.jsx(D,{className:"h-4 w-4"}):p(t,["инспектор","советник","секрет","контрол"])?o.jsx(V,{className:"h-4 w-4"}):p(t,["министр","губернатор","админ","руковод"])?o.jsx(z,{className:"h-4 w-4"}):o.jsx(v,{className:"h-4 w-4"})}const f=[];var N,S,C;for(const e of R){const t=Array.isArray(e.dept)?e.dept.includes("ЮД")?"юридический":e.dept.includes("ДВД")||e.dept.includes("охрана")?"охрана":e.dept.includes("АДМ")?"админ":void 0:void 0;f.push({id:`role:${e.id}`,type:"role",title:e.role,tags:[e.role.split(" ")[0].toLowerCase(),...(((N=e.duties)==null?void 0:N.slice(0,3))||[]).map(n=>n.split(" ")[0].toLowerCase())],dept:t||"неизвестно",level:parseInt(((S=String(e.role).match(/\((\d+)\)/))==null?void 0:S[1])||"0",10),description:((C=e.duties)==null?void 0:C[0])||void 0})}var k,L;for(const e of O)f.push({id:`procedure:${e.id}`,type:"procedure",title:e.role,tags:[e.role.split(" ")[0].toLowerCase(),...(((k=e.tips)==null?void 0:k.slice(0,3))||[]).map(t=>t.split(" ")[0].toLowerCase())],dept:"админ",description:((L=e.tips)==null?void 0:L[0])||void 0});function U(e){return f.find(t=>t.id===e)}function G(e,t){if(e=e.toLowerCase(),t=t.toLowerCase(),e.includes(t))return 2;const n=new Set(e.split(/[^\p{L}\p{N}]+/u).filter(Boolean)),i=new Set(t.split(/[^\p{L}\p{N}]+/u).filter(Boolean));let r=0;for(const l of i)n.has(l)&&r++;return r>0?1:0}function P(e,t=6){const n=s=>e.dept&&s?e.dept===s:!0,i=new Set((e.tags||[]).map(s=>s.toLowerCase()));function r(s){if(s.id===e.id)return-1;let c=0;n(s.dept)&&(c+=2);const d=(s.tags||[]).reduce((u,A)=>u+(i.has(String(A).toLowerCase())?1:0),0);return c+=Math.min(d,3),c+=G(s.title,e.title),c}const l=f.filter(s=>s.type!==e.type).map(s=>({m:s,s:r(s)})).filter(s=>s.s>0).sort((s,c)=>c.s-s.s).slice(0,t*2).map(s=>s.m),a={procedures:[],templates:[],roles:[]};for(const s of l)s.type==="procedure"&&a.procedures.length<t?a.procedures.push(s):s.type==="template"&&a.templates.length<t?a.templates.push(s):s.type==="role"&&a.roles.length<t&&a.roles.push(s);return a}function h({title:e,items:t}){return t.length?o.jsxs("div",{className:"mt-2 text-xs",children:[o.jsx("div",{className:"mb-1 font-semibold opacity-70",children:e}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:t.slice(0,6).map(n=>o.jsx("span",{title:n.description||n.title,className:"inline-flex max-w-[14rem] items-center gap-1 truncate rounded-full border px-2 py-0.5 hover:bg-zinc-100 dark:hover:bg-zinc-800",children:o.jsx("span",{className:"truncate",children:n.title})},n.id))})]}):null}function X({itemId:e,itemType:t}){const n=U(e);if(!n)return o.jsx("div",{className:"mt-2 text-xs italic opacity-60",children:"Пока без связей"});const i=P(n),r=i.procedures.length+i.templates.length+i.roles.length;return o.jsxs("div",{className:"mt-3 rounded-xl border border-zinc-200 p-2 dark:border-zinc-800",children:[o.jsxs("div",{className:"mb-1 text-xs font-semibold",children:["Связано с этим: ",r]}),o.jsx(h,{title:"Процедуры",items:i.procedures}),o.jsx(h,{title:"Шаблоны",items:i.templates}),o.jsx(h,{title:"Роли",items:i.roles}),!r&&o.jsx("div",{className:"text-xs opacity-60",children:"Пока без связей"})]})}const w={},T=(w==null?void 0:w.VITE_VOTE_API_BASE)||"https://notifications-worker.wizardiowhy.workers.dev/skyapi",x=new Set;let y=null;const b=new Map;function B(){try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{}return null}function j(e){const t=B();try{return t?t.getItem(e):null}catch{return null}}function $(e,t){const n=B();try{n==null||n.setItem(e,t)}catch{}}function F(e,t){b.set(e,t)}function J(e){b.delete(e)}function M(e){x.add(e),!y&&(y=setTimeout(async()=>{var t;try{const n=[...x];x.clear(),y=null;const r=await(await fetch(`${T}/api/stats?ids=${encodeURIComponent(n.join(","))}`)).json(),l=(r==null?void 0:r.stats)||{};for(const[a,s]of Object.entries(l))(t=b.get(a))==null||t(s)}catch{}},120))}function W(){const e="anon_uid";let t=j(e);return t||(t=crypto.randomUUID(),$(e,t)),t}async function _(e,t){if(j("telemetry_disabled")==="1")return null;const n=`voted:${e}`;if(j(n))return null;$(n,"1");try{const r=await(await fetch(`${T}/api/vote`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({card_id:e,vote:t,anon_uid:W()})})).json();if(r!=null&&r.ok&&r.totals)return r.totals}catch{}return null}function g(e){try{return typeof window<"u"?window.localStorage.getItem(e):null}catch{return null}}function Y({cardId:e}){const[t,n]=m.useState({up:0,down:0}),[i,r]=m.useState(!1),l=!!g(`voted:${e}`),a=i||l||g("telemetry_disabled")==="1";m.useEffect(()=>(M(e),F(e,n),()=>J(e)),[e]);async function s(c){if(a)return;r(!0),n(u=>({up:u.up+(c===1?1:0),down:u.down+(c===-1?1:0)}));const d=await _(e,c);d&&n(d),r(!1)}return g("telemetry_disabled")==="1"?null:o.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs",children:[o.jsxs("button",{className:"btn",onClick:()=>s(1),disabled:a,children:[o.jsx(E,{className:"h-4 w-4"})," ",t.up]}),o.jsxs("button",{className:"btn",onClick:()=>s(-1),disabled:a,children:[o.jsx(I,{className:"h-4 w-4"})," ",t.down]})]})}export{X as R,Y as V,O as a,Q as i};
