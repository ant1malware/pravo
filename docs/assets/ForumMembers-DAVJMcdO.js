import{j as e}from"./index-BsITee45.js";import{R as o,L as v}from"./react-vendor-DTkXckhQ.js";import{F as C}from"./ForumSubnav-Dz_SL7W6.js";import{c as $,B as E}from"./Badge-C0HwEQFP.js";import{g as F,l as A,d as M}from"./authRemote-Dz2u5_CF.js";import{U as P,a as D,$ as R}from"./icons-GyIOUIPt.js";import"./forumRemote-D5s3MT8n.js";const T={developer:{label:"Developer",color:"#22d3ee"},admin:{label:"Admin",color:"#ef4444"},moderator:{label:"Moderator",color:"#8b5cf6"},vip:{label:"VIP",color:"#eab308"},user:{label:"User",color:"#94a3b8"},newbie:{label:"Newbie",color:"#22d3ee"}};function B({role:t}){const l=T[t]||{label:t,color:"#94a3b8"};return e.jsx("span",{className:"rounded-full border border-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.26em]",style:{color:l.color},children:l.label})}function U({member:t,highlight:l}){const h=t.score??$({posts:t.posts,likes:t.likes,topics:t.topics}),j=t.profile.accentFrom||"#22d3ee",d=t.profile.accentTo||"#8b5cf6",i=t.profile.avatarData;return e.jsxs(v,{to:"/forum/profile/"+t.username,className:`card group flex flex-col gap-3 p-4 transition duration-200 hover:border-cyan-400/50 ${l?"border-cyan-500/60":""}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"relative h-14 w-14 overflow-hidden rounded-2xl border border-white/5",children:i?e.jsx("img",{src:i,alt:`${t.username} avatar`,className:"h-full w-full object-cover",loading:"lazy"}):e.jsx("div",{className:"h-full w-full",style:{background:`linear-gradient(135deg, ${j}, ${d})`}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-lg font-semibold text-white",children:t.username}),e.jsx(B,{role:t.role}),e.jsx(E,{points:h}),l&&e.jsx("span",{className:"rounded-full bg-cyan-500/10 px-2 py-0.5 text-[11px] uppercase tracking-[0.3em] text-cyan-300",children:"You"})]}),e.jsxs("div",{className:"mt-1 text-xs text-zinc-400/80",children:["Joined ",new Date(t.createdAt).toLocaleDateString()]})]}),e.jsx(R,{size:16,className:"opacity-0 transition-transform duration-200 group-hover:translate-x-1 group-hover:opacity-100"})]}),t.profile.bio&&e.jsx("div",{className:"line-clamp-2 text-sm text-zinc-300/80",children:t.profile.bio}),e.jsxs("div",{className:"mt-auto flex items-center gap-4 text-[11px] uppercase tracking-[0.28em] text-zinc-400/80",children:[e.jsxs("span",{children:["Topics ",t.topics]}),e.jsxs("span",{children:["Posts ",t.posts]}),e.jsxs("span",{children:["Likes ",t.likes]})]})]})}function _(){const[t,l]=o.useState([]),[h,j]=o.useState(""),[d,i]=o.useState(null),[N,p]=o.useState(!0),[f,w]=o.useState(null),b=o.useCallback((a,s=0)=>{const c=a||"user";let r=0;for(let u=0;u<c.length;u++)r=(r<<5)-r+c.charCodeAt(u),r|=0;return`hsl(${(Math.abs(r)+s*63)%360}, 62%, ${s?52:58}%)`},[]),k=o.useCallback((a,s)=>{var c,r,m,x,n;return{bio:(s==null?void 0:s.bio)||"",signature:(s==null?void 0:s.signature)||"",links:(s==null?void 0:s.links)||{},avatarData:s==null?void 0:s.avatarData,accentFrom:(s==null?void 0:s.accentFrom)||b(a.username,0),accentTo:(s==null?void 0:s.accentTo)||b(a.username,1),badges:(s==null?void 0:s.badges)||[],privacy:{showEmail:!!((c=s==null?void 0:s.privacy)!=null&&c.showEmail),showStats:((r=s==null?void 0:s.privacy)==null?void 0:r.showStats)!==!1,showLinks:(m=s==null?void 0:s.privacy)==null?void 0:m.showLinks,allowComments:(x=s==null?void 0:s.privacy)==null?void 0:x.allowComments,showFollowers:(n=s==null?void 0:s.privacy)==null?void 0:n.showFollowers}}},[b]);o.useEffect(()=>{const a=async()=>{p(!0);try{const[c,r]=await Promise.all([F(),A()]);if(r!=null&&r.length){const m=await Promise.all(r.map(async n=>{if(n.profile)return n.profile;try{return await M(n.id)}catch{return null}})),x=r.map((n,u)=>({id:n.id,username:n.username,email:`${n.username}@hidden.local`,createdAt:n.createdAt,role:n.role,userNumber:n.userNumber,posts:n.posts??0,likes:n.likes??0,topics:n.topics??0,profile:k(n,m[u]),bans:null,mutes:null}));l(x),i(c?{id:c.id,username:c.username}:null),w(null),p(!1);return}l([]),i(c?{id:c.id,username:c.username}:null),w(null),p(!1);return}catch{w("Не удалось загрузить участников")}p(!1),l([]),i(null)};a();const s=()=>a();return window.addEventListener("forum:session",s),window.addEventListener("storage",s),()=>{window.removeEventListener("forum:session",s),window.removeEventListener("storage",s)}},[k]);const g=h.trim().toLowerCase(),y=t.filter(a=>g?a.username.toLowerCase().includes(g)||a.email.toLowerCase().includes(g)||a.role.toLowerCase().includes(g):!0).sort((a,s)=>a.username.localeCompare(s.username)),L=t.filter(a=>a.role==="developer"),z=t.filter(a=>a.role==="admin"),S=t.filter(a=>a.role==="moderator");return e.jsx("main",{className:"min-h-screen",style:{background:"radial-gradient(900px 620px at 18% -12%, rgba(59,130,246,0.2), transparent 65%), radial-gradient(1200px 760px at 92% 0%, rgba(236,72,153,0.18), transparent 68%), #0d0d12",color:"#f8fafc"},children:e.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-6",children:[e.jsx(C,{}),e.jsx("div",{className:"card mb-6 overflow-hidden",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 px-5 py-6",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-cyan-400/10 text-cyan-300",children:e.jsx(P,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm uppercase tracking-[0.38em] text-zinc-400/70",children:"Community"}),e.jsx("h1",{className:"text-3xl font-extrabold text-white",children:"Members"}),e.jsx("p",{className:"mt-1 text-sm text-zinc-300/80",children:"Browse every registered profile, discover new collaborators, and jump straight into a member's timeline."})]})]})}),e.jsxs("div",{className:"mb-5 grid gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"mb-2 text-xs uppercase tracking-[0.28em] text-cyan-300/80",children:"Developers"}),e.jsxs("div",{className:"grid gap-2",children:[L.slice(0,6).map(a=>e.jsxs(v,{to:`/forum/profile/${a.username}`,className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-cyan-400"}),e.jsx("span",{className:"font-semibold",children:a.username})]},a.id)),!L.length&&e.jsx("div",{className:"text-xs opacity-60",children:"No developers yet"})]})]}),e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"mb-2 text-xs uppercase tracking-[0.28em] text-rose-300/80",children:"Admins"}),e.jsxs("div",{className:"grid gap-2",children:[z.slice(0,8).map(a=>e.jsxs(v,{to:`/forum/profile/${a.username}`,className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-rose-400"}),e.jsx("span",{className:"font-semibold",children:a.username})]},a.id)),!z.length&&e.jsx("div",{className:"text-xs opacity-60",children:"No admins yet"})]})]}),e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"mb-2 text-xs uppercase tracking-[0.28em] text-violet-300/80",children:"Moderators"}),e.jsxs("div",{className:"grid gap-2",children:[S.slice(0,8).map(a=>e.jsxs(v,{to:`/forum/profile/${a.username}`,className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-violet-400"}),e.jsx("span",{className:"font-semibold",children:a.username})]},a.id)),!S.length&&e.jsx("div",{className:"text-xs opacity-60",children:"No moderators yet"})]})]})]}),e.jsxs("div",{className:"card mb-5 flex flex-col gap-4 px-4 py-3 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/70",children:"Поиск"}),e.jsx("div",{className:"text-lg font-semibold text-white",children:"Find members"})]}),e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-zinc-500"}),e.jsx("input",{className:"input w-full pl-9",placeholder:"Search members by name, email, or role",value:h,onChange:a=>j(a.target.value),disabled:N&&!t.length})]}),e.jsxs("div",{className:"mt-2 text-xs uppercase tracking-[0.26em] text-zinc-500",children:[y.length," of ",t.length]})]})]}),f&&e.jsx("div",{className:"card mb-5 border border-rose-500/40 bg-rose-500/10 p-4 text-sm text-rose-100",children:f}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:y.map(a=>e.jsx(U,{member:a,highlight:(d==null?void 0:d.id)===a.id},a.id))}),N&&e.jsx("div",{className:"card mt-6 p-5 text-sm text-zinc-300/80",children:"Загружаем участников..."}),!N&&!y.length&&e.jsx("div",{className:"card mt-6 p-5 text-sm text-zinc-300/80",children:"No members match that query yet."})]})})}export{_ as default};
