import{j as e}from"./index-SvquseAp.js";import{b as m,R as c,L as l}from"./react-vendor-DTkXckhQ.js";import{g as d,F as f}from"./ForumSubnav-Cb6ZP_YC.js";import{F as x}from"./ForumSearch-D6gs6iuR.js";import{listTopics as p}from"./forumRemote-D5s3MT8n.js";import{s as h}from"./seo-Dt7ixYh-.js";import"./icons-wEjUy8Cq.js";function N(){const i=m(),s=new URLSearchParams(i.search||"").get("feed"),[a,u]=c.useState(s||d()),[t,r]=c.useState([]);return c.useEffect(()=>{try{h("\u041B\u0435\u043D\u0442\u044B \u2014 \u0424\u043E\u0440\u0443\u043C","\u0413\u043E\u0440\u044F\u0447\u0435\u0435, \u043D\u043E\u0432\u043E\u0435 \u0438 \u0432\u043E\u043F\u0440\u043E\u0441\u044B \u0444\u043E\u0440\u0443\u043C\u0430")}catch{}},[]),c.useEffect(()=>{let o=!0;return(async()=>{try{const n=await p();o&&r(n||[])}catch{o&&r([])}})(),()=>{o=!1}},[]),c.useEffect(()=>{s&&u(s)},[s]),e.jsx("main",{className:"min-h-screen",style:{background:"#0d0d12",color:"#f8fafc"},children:e.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-6",children:[e.jsx(f,{}),e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx("button",{className:`tab ${a==="hot"?"tab-active":""}`,onClick:()=>u("hot"),children:"\u0413\u043E\u0440\u044F\u0447\u0435\u0435"}),e.jsx("button",{className:`tab ${a==="new"?"tab-active":""}`,onClick:()=>u("new"),children:"\u041D\u043E\u0432\u043E\u0435"}),e.jsx(l,{className:"tab",to:"/forum/questions",children:"\u0412\u043E\u043F\u0440\u043E\u0441\u044B"})]}),e.jsx(x,{}),e.jsx("div",{className:"mt-4",children:e.jsx(E,{feed:a,topics:t})})]})})}function E({feed:i,topics:s}){const a=c.useMemo(()=>{const u=(s||[]).slice();return i==="new"?u.sort((t,r)=>new Date(r.createdAt).getTime()-new Date(t.createdAt).getTime()).slice(0,20):u.map(t=>({t,s:(t.replyCount||0)*2+(t.viewCount||0)*.1-Math.max(0,(Date.now()-new Date(t.updatedAt).getTime())/36e5)*.02})).sort((t,r)=>r.s-t.s).slice(0,20).map(t=>t.t)},[i,s]);return a.length===0?e.jsx("div",{className:"card p-4 text-sm opacity-70",children:"\u041B\u0435\u043D\u0442\u0430 \u043F\u0443\u0441\u0442\u0430."}):e.jsx("div",{className:"grid gap-3",children:a.map(u=>e.jsxs("a",{href:`/forum/topic/${u.id}`,className:"block rounded-xl border border-white/10 bg-white/[0.04] p-3",children:[e.jsx("div",{className:"font-semibold truncate",children:u.title}),e.jsxs("div",{className:"mt-1 text-xs opacity-70",children:["\u041E\u0442\u0432\u0435\u0442\u043E\u0432 ",u.replyCount," \u2022 \u041F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u044B ",u.viewCount," \u2022 \u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E ",new Date(u.updatedAt).toLocaleString()]})]},u.id))})}export{N as default};
