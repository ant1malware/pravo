import{j as s}from"./index-BBBHUoXu.js";import{b as j,R as i,L as c}from"./react-vendor-DTkXckhQ.js";import{l as v}from"./forumRemote-B4nbC4GM.js";import{aw as k,av as y,U as N,ac as S}from"./icons-CI_uwdm-.js";const p="forum:default_feed";function $(){try{const t=localStorage.getItem(p);if(t==="hot"||t==="new"||t==="questions")return t}catch{}return"hot"}function C(t){try{localStorage.setItem(p,t)}catch{}}function W(){const t=j(),[a,m]=i.useState(null);i.useEffect(()=>{let e=!0;return(async()=>{try{const n=(await v()||[]).find(r=>String(r.title||"").toLowerCase()==="workshop");e&&m((n==null?void 0:n.id)||null)}catch{e&&m(null)}})(),()=>{e=!1}},[]);const u=t.pathname.includes("/forum/members"),d=a?t.pathname.startsWith(`/forum/section/${a}`):!1,b=!u&&!d,f=new URLSearchParams(t.search||"").get("feed"),h=({to:e,active:l,icon:n,children:r,disabled:w})=>w?s.jsxs("span",{className:`btn inline-flex items-center gap-2 ${l?"btn-primary":""}`,title:"Workshop section is not created yet","aria-disabled":!0,children:[n," ",r]}):s.jsxs(c,{to:e,className:`btn inline-flex items-center gap-2 ${l?"btn-primary":""}`,children:[n," ",r]}),[x,o]=i.useState(!1);i.useEffect(()=>{const e=()=>o(!1);return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);const g=$();return s.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[s.jsxs("div",{className:"relative",onClick:e=>e.stopPropagation(),children:[s.jsxs("button",{className:`btn inline-flex items-center gap-2 ${b?"btn-primary":""}`,onClick:()=>o(e=>!e),children:[s.jsx(k,{size:16})," Forums ",s.jsx(y,{size:14})]}),x&&s.jsxs("div",{className:"absolute left-0 z-20 mt-1 w-64 rounded-xl border border-white/10 bg-[color:var(--surface)] p-1 shadow-lg",children:[s.jsx(c,{className:`block rounded-lg px-3 py-2 hover:bg-white/5 ${f==="hot"?"bg-white/5":""}`,to:"/forum/feeds?feed=hot",onClick:()=>{o(!1)},children:"Горячее"}),s.jsx(c,{className:`block rounded-lg px-3 py-2 hover:bg-white/5 ${f==="new"?"bg-white/5":""}`,to:"/forum/feeds?feed=new",onClick:()=>{o(!1)},children:"Новое"}),s.jsx(c,{className:`block rounded-lg px-3 py-2 hover:bg-white/5 ${t.pathname.includes("/forum/questions")?"bg-white/5":""}`,to:"/forum/questions",onClick:()=>o(!1),children:"Вопросы"}),s.jsxs("div",{className:"mt-1 border-t border-white/10 p-2 text-xs opacity-80",children:["Лента по умолчанию:",["hot","new","questions"].map(e=>s.jsx("button",{className:`ml-2 tab ${g===e?"tab-active":""}`,onClick:()=>{C(e),o(!1)},children:e},e))]})]})]}),s.jsx(h,{to:"/forum/members",active:u,icon:s.jsx(N,{size:16}),children:"Members"}),s.jsx(h,{to:a?`/forum/section/${a}`:"/forum",active:d,icon:s.jsx(S,{size:16}),disabled:!a,children:"Workshop"})]})}export{W as F,$ as g};
