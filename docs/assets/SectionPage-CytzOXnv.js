import{j as s}from"./index-BjJS3am-.js";import{u as g,R as t,L as h}from"./react-vendor-DTkXckhQ.js";import{l as b,b as N,c as v}from"./forumRemote-DHJrJEKR.js";import{F as y}from"./ForumSubnav-D4O2v9VB.js";import{ab as S,ac as w,ad as k}from"./icons-C8fXSpVf.js";function B(){const{id:l=""}=g(),[a,o]=t.useState(null),[d,m]=t.useState([]),[p,x]=t.useState(""),[u,f]=t.useState(!1),n=t.useCallback(async()=>{try{const[e,c]=await Promise.all([b(),N(l)]);o(e.find(r=>r.id===l)||null),m(Array.isArray(c)?c:[])}catch{o(null),m([])}},[l]);t.useEffect(()=>{n()},[n]);const i=((a==null?void 0:a.title)||"").toLowerCase()==="workshop",j=async e=>{e.preventDefault();const c=p.trim();if(c){f(!0);try{await v({sectionId:l,title:c}),x(""),n()}catch(r){alert((r==null?void 0:r.message)||"Failed to create topic")}finally{f(!1)}}};return s.jsx("main",{className:"min-h-screen",style:{background:"radial-gradient(900px 620px at 18% -12%, rgba(59,130,246,0.18), transparent 65%), radial-gradient(1200px 760px at 92% 0%, rgba(236,72,153,0.16), transparent 68%), #0d0d12",color:"#f8fafc"},children:s.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-6",children:[s.jsx(y,{}),s.jsxs("div",{className:"mb-5 flex items-center gap-3",children:[s.jsxs(h,{to:"/forum",className:"btn flex items-center gap-2",children:[s.jsx(S,{size:16})," Back"]}),s.jsx("div",{className:"text-sm opacity-70",children:"Section"}),s.jsx("div",{className:"font-semibold",children:(a==null?void 0:a.title)||"..."})]}),i&&s.jsxs("div",{className:"card mb-4 p-4",children:[s.jsxs("div",{className:"mb-2 flex items-center gap-2 font-semibold",children:[s.jsx(w,{size:16})," Workshop: Товары"]}),s.jsx("div",{className:"text-sm opacity-70",children:"Выставляйте свои товары и предложения. Каждая тема — отдельный лот."})]}),s.jsxs("form",{onSubmit:j,className:"card mb-4 grid gap-2 p-4 sm:grid-cols-[1fr_auto]",children:[s.jsx("input",{className:"input",placeholder:i?"Название товара / лота":"Topic title",value:p,onChange:e=>x(e.target.value),disabled:u}),s.jsxs("button",{className:"btn btn-primary flex items-center gap-2",disabled:u,children:[s.jsx(k,{size:16})," ",i?"Добавить товар":"Создать тему"]})]}),s.jsxs("div",{className:"grid gap-3",children:[d.map(e=>s.jsxs(h,{to:`/forum/topic/${e.id}`,className:`card p-4 ${i?"grid grid-cols-[1fr_auto] items-center":""}`,children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"font-semibold truncate",children:e.title}),s.jsxs("div",{className:"mt-1 text-xs opacity-70",children:["replies: ",e.replyCount," • views: ",e.viewCount]})]}),i&&s.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-emerald-300/80",children:"Товар"})]},e.id)),!d.length&&s.jsx("div",{className:"card p-4 text-sm opacity-70",children:"No topics yet."})]})]})})}export{B as default};
