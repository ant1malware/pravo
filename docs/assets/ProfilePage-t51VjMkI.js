import{b as se,m as Ne,n as ae,j as e,o as we,p as ye,q as ke}from"./index-679bRXRM.js";import{u as Se,R as i}from"./react-vendor-DTkXckhQ.js";import{f as re,g as le,u as Ce,a as ze}from"./forumStore-B6WwSblf.js";import{a as ne,i as Ae,u as $e,f as Re,b as P,c as Ee,r as Pe,d as Fe,e as _e,g as De,t as Le}from"./socialStore-D4aUy79F.js";import{c as Be,B as Te}from"./Badge-Ahke-Lwy.js";import{J as Oe,N as Ie,O as ie,V as ce,S as oe,W as de,Y as Me,Z as Ue,_ as Ve,$ as We,a0 as he,a1 as me,M as Ge,a2 as qe}from"./icons-CXNlrW03.js";const xe={developer:{label:"Разработчик",color:"#22d3ee",glow:"from-cyan-400/35"},admin:{label:"Администратор",color:"#e5e7eb",glow:"from-white/40"},moderator:{label:"Модератор",color:"#ef4444",glow:"from-rose-400/35"},vip:{label:"VIP",color:"#eab308",glow:"from-amber-400/35"},user:{label:"Участник",color:"#94a3b8",glow:"from-slate-300/30"},newbie:{label:"Новичок",color:"#22d3ee",glow:"from-cyan-400/35"}},O={owner:{label:"Owner",grad:"from-amber-400 via-rose-400 to-amber-400",Icon:de},developer:{label:"Developer",grad:"from-emerald-400 via-lime-400 to-emerald-400",Icon:ce},admin:{label:"Admin",grad:"from-white via-slate-200 to-white",Icon:oe},moderator:{label:"Moderator",grad:"from-rose-400 via-red-400 to-rose-400",Icon:Me},vip:{label:"Premium",grad:"from-amber-400 via-yellow-300 to-amber-400",Icon:de},user:{label:"User",grad:"from-slate-300 via-slate-400 to-slate-300",Icon:oe},newbie:{label:"Newbie",grad:"from-cyan-400 via-fuchsia-400 to-cyan-400",Icon:ce}};function pe(s){switch(s){case"developer":return"linear-gradient(90deg,#22c55e,#84cc16)";case"admin":return"linear-gradient(90deg,#ffffff,#d1d5db)";case"moderator":return"linear-gradient(90deg,#ef4444,#f43f5e)";case"vip":return"linear-gradient(90deg,#eab308,#facc15)";default:return null}}function Ye(s){if(!s)return!1;if(!s.until)return!0;const t=new Date(s.until).getTime();return!Number.isNaN(t)&&t>Date.now()}function He(s){const t=s.lastActiveAt||ke(s.id);if(!t)return!1;const a=new Date(t).getTime();return!Number.isNaN(a)&&a>Date.now()-5*60*1e3}const w="rounded-3xl border border-white/10 bg-[#101321]/85 p-5 shadow-[0_40px_120px_-70px_rgba(15,23,42,0.9)] backdrop-blur",u="rounded-3xl border border-white/10 bg-white/[0.05] p-4 shadow-[0_30px_90px_-70px_rgba(15,23,42,0.85)] backdrop-blur";function Je({role:s}){const t=O[s]??O.user,a=t.Icon;return e.jsxs("span",{className:"relative inline-flex",children:[e.jsx("span",{className:`absolute -inset-[2px] rounded-full blur-md bg-gradient-to-r ${t.grad} opacity-50`}),e.jsxs("span",{className:"relative inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3.5 py-1.5 text-[11px] font-extrabold uppercase tracking-[0.22em] text-white",children:[e.jsx(a,{size:14,className:"opacity-90"}),t.label]})]})}function Xe({role:s}){const t=O[s]??O.user;return e.jsx("span",{className:"rounded-full border border-white/15 bg-black/50 px-2 py-0.5 text-[10px] font-bold uppercase tracking-[0.18em] text-white backdrop-blur",children:t.label})}function U({value:s,label:t}){return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-extrabold text-white",children:s}),e.jsx("div",{className:"mt-0.5 text-[11px] uppercase tracking-[0.28em] text-zinc-300/80",children:t})]})}function Ze({badges:s}){if(!(s!=null&&s.length))return null;const t={Founder:"from-rose-500/25 to-rose-400/10 text-rose-200",Early:"from-sky-500/25 to-sky-400/10 text-sky-200",Contributor:"from-emerald-500/25 to-emerald-400/10 text-emerald-200",VIP:"from-amber-500/25 to-amber-400/10 text-amber-200",Designer:"from-violet-500/25 to-violet-400/10 text-violet-200"};return e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:s.slice(0,3).map(a=>e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full border border-white/10 bg-gradient-to-br ${t[a]||"from-white/20 to-white/5 text-zinc-200"} px-2.5 py-1 text-xs`,children:[e.jsx(he,{size:14,className:"opacity-90"})," ",a]},a))})}function ue(s){const t=s.profile||{},a=s.stats||{},n=s.lastActiveAt||s.lastSeenAt||s.lastOnlineAt||null,r={bio:t.bio||"",signature:t.signature||"",links:t.links?{...t.links}:{},accentFrom:t.accentFrom||"#8b5cf6",accentTo:t.accentTo||"#0ea5e9",avatarData:t.avatarData||t.avatar||t.avatarUrl||void 0,bannerData:t.bannerData||t.banner||t.bannerUrl||void 0,badges:Array.isArray(t.badges)?t.badges:[],privacy:{showEmail:!1,showStats:!0,showLinks:!0,allowComments:!0,showFollowers:!0,...t.privacy||{}}};Array.isArray(t.labels)&&(r.labels=t.labels);const c={id:s.user.id,username:s.user.username,email:s.user.email,createdAt:s.user.createdAt,role:s.user.role,userNumber:s.user.userNumber,posts:typeof a.posts=="number"?a.posts:0,likes:typeof a.likes=="number"?a.likes:0,topics:typeof a.topics=="number"?a.topics:0,profile:r,bans:s.user.bannedUntil?{until:s.user.bannedUntil}:null,mutes:null};return typeof a.score=="number"&&(c.score=a.score),n&&(c.lastActiveAt=n),c}function pt(){var D,z,L,A,B,$;const{username:s=""}=Se(),[t,a]=i.useState(null),[n,r]=i.useState(null),[c,d]=i.useState(!1),[m,x]=i.useState(!1),[b,g]=i.useState({}),[p,F]=i.useState("posts");if(i.useEffect(()=>{(async()=>{var f;try{const j=await se();if(j){d(!0),r({id:j.id,username:j.username});try{const M=await Ne(),R={};for(const T of M)R[T.id]=T.username;g(R)}catch{}const k=await ae(s);if(k){a(ue(k)),x(!!((f=k.user)!=null&&f.owner));return}}}catch{}d(!1),a(re(s)||null);const o=le();r(o?{id:o.id,username:o.username}:null)})()},[s]),i.useEffect(()=>{const o=async()=>{try{const j=await se();if(j){r({id:j.id,username:j.username});return}}catch{}const f=le();r(f?{id:f.id,username:f.username}:null)};return window.addEventListener("forum:session",o),window.addEventListener("storage",o),()=>{window.removeEventListener("forum:session",o),window.removeEventListener("storage",o)}},[]),!t)return e.jsx("main",{className:"min-h-screen text-slate-200",style:{background:"linear-gradient(180deg,#04060d 0%,#090b16 100%)"},children:e.jsx("div",{className:"mx-auto max-w-3xl px-4 py-16",children:e.jsx("div",{className:`${w} text-center text-sm text-zinc-300`,children:"Требуется вход для просмотра профилей."})})});const I=(n==null?void 0:n.id)===t.id,y=t.profile.accentFrom||"#22d3ee",C=t.profile.accentTo||"#8b5cf6",v=Ye(t.bans),N=He(t),_=t.score??Be({posts:t.posts,likes:t.likes,topics:t.topics});return e.jsx("main",{className:"min-h-screen text-slate-100",style:{background:"radial-gradient(1200px 700px at 12% -10%, rgba(56,189,248,0.18), transparent 65%), radial-gradient(1000px 720px at 90% -6%, rgba(167,139,250,0.14), transparent 70%), linear-gradient(180deg, #04060d 0%, #090b16 100%)"},children:e.jsxs("div",{className:"mx-auto max-w-5xl px-4 py-8 space-y-6",children:[e.jsxs("section",{className:"relative overflow-hidden rounded-3xl border border-white/10 bg-[#101321]/85 shadow-[0_50px_140px_-80px_rgba(15,23,42,0.9)] backdrop-blur",children:[e.jsx("div",{className:"h-[220px] w-full",style:{background:t.profile.bannerData?`url(${t.profile.bannerData}) center/cover`:`linear-gradient(135deg, ${y}, ${C})`}}),e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/15 via-transparent to-black/70"}),e.jsxs("div",{className:"relative -mt-16 flex flex-wrap items-end gap-5 px-6 pb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"rounded-full p-[3px]",style:{backgroundImage:pe(t.role)||`linear-gradient(135deg,${y},${C})`},children:e.jsx("div",{className:"h-24 w-24 overflow-hidden rounded-full border-4 border-[#101321] shadow-[0_25px_70px_-35px_rgba(15,23,42,0.9)]",style:{background:t.profile.avatarData?`url(${t.profile.avatarData}) center/cover`:`linear-gradient(135deg, ${y}, ${C})`}})}),e.jsx("span",{className:`absolute -right-1 bottom-2 h-4 w-4 rounded-full border-2 ${N?"border-emerald-900/60 bg-emerald-400":"border-zinc-900/70 bg-zinc-400/70"}`,title:N?"Online":"Offline",children:N&&e.jsx("span",{className:"absolute inset-0 -z-10 animate-ping rounded-full bg-emerald-400/50"})}),e.jsx("div",{className:`absolute -inset-1 -z-10 rounded-full bg-gradient-to-br ${(xe[t.role]||xe.user).glow} to-transparent blur-lg`}),e.jsx("div",{className:"absolute -bottom-2 left-1",children:e.jsx(Xe,{role:t.role})})]}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("h1",{className:`text-3xl font-extrabold tracking-tight ${v?"line-through text-black":"text-white"}`,style:v?void 0:(()=>{const o=pe(t.role);return o?{backgroundImage:o,WebkitBackgroundClip:"text",backgroundClip:"text",WebkitTextFillColor:"transparent"}:void 0})(),children:t.username}),e.jsxs("span",{className:"rounded-full border border-white/10 bg-white/10 px-2 py-0.5 text-[11px] uppercase tracking-[0.28em] text-zinc-200/80",children:["#",t.userNumber]}),e.jsx(Te,{points:_}),v&&e.jsx("span",{className:"rounded-full bg-black/50 px-2 py-0.5 text-[11px] uppercase tracking-[0.26em] text-zinc-200",children:"Banned"}),!v&&e.jsx("span",{className:`rounded-full px-2 py-0.5 text-[11px] uppercase tracking-[0.26em] ${N?"bg-emerald-500/15 text-emerald-200":"bg-white/10 text-zinc-300"}`,children:N?"Online":t.lastActiveAt?we(t.lastActiveAt):"—"})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx(Je,{role:t.role})}),e.jsxs("div",{className:"mt-2 flex items-center gap-8",children:[e.jsx(U,{value:t.posts,label:"messages"}),e.jsx(U,{value:t.likes,label:"reaction score"}),e.jsx(U,{value:t.topics,label:"topics"})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-sm",children:[e.jsx("button",{className:"rounded-full border border-white/10 bg-white/10 px-3 py-1 hover:border-white/30",onClick:()=>alert("Points system coming soon ♥"),children:"Send points"}),e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"rounded-full border border-white/10 bg-white/10 px-3 py-1 hover:border-white/30 inline-flex items-center gap-2",children:["Find ",e.jsx(Oe,{size:14})]}),e.jsxs("div",{className:"absolute left-0 top-full hidden w-56 rounded-xl border border-white/10 bg-[#0b0f1b]/95 p-2 text-sm text-zinc-200 shadow-2xl backdrop-blur group-hover:block",children:[e.jsx("a",{className:"block rounded-lg px-2 py-1 hover:bg-white/10",href:`/forum/search?author=${encodeURIComponent(t.username)}`,children:"Все сообщения"}),e.jsx("a",{className:"block rounded-lg px-2 py-1 hover:bg-white/10",href:`/forum/search?starter=${encodeURIComponent(t.username)}`,children:"Темы пользователя"})]})]})]})]}),I?e.jsx(rt,{user:t,onUpdated:async()=>{if(c){const o=await ae(s);o&&a(ue(o))}else a(re(s)||null)},saveProfile:async o=>{c?await ye(o):Ce(t.id,o)}}):e.jsx("div",{className:"flex gap-2",children:e.jsx(Ke,{session:n,user:t})})]}),e.jsx("div",{className:"px-6",children:e.jsx("div",{className:"mt-2 flex items-center gap-6 border-t border-white/10 pt-3 text-sm",children:[{k:"posts",label:"Profile posts"},{k:"activity",label:"Latest activity"},{k:"postings",label:"Postings"},{k:"about",label:"About"}].map(({k:o,label:f})=>e.jsx("button",{className:`pb-2 ${p===o?"border-b-2 border-cyan-400 text-white":"text-zinc-400 hover:text-zinc-200"}`,onClick:()=>F(o),children:f},o))})})]}),p==="about"&&e.jsxs("section",{className:"grid gap-4 lg:grid-cols-[1.35fr_.85fr]",children:[e.jsxs("div",{className:w,children:[e.jsx("div",{className:"mb-3 text-xs uppercase tracking-[0.3em] text-zinc-400/75",children:"О себе"}),e.jsx("p",{className:"whitespace-pre-wrap text-sm text-zinc-200/85",children:t.profile.bio||"Пока нет описания."}),e.jsx("div",{className:"mt-3",children:e.jsx(Ze,{badges:t.profile.badges})})]}),e.jsxs("div",{className:w,children:[e.jsx("div",{className:"mb-3 text-xs uppercase tracking-[0.3em] text-zinc-400/75",children:"Ссылки"}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-zinc-200/90",children:[(D=t.profile.links)!=null&&D.website?e.jsxs("a",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-3 py-1 hover:border-white/30",href:t.profile.links.website,target:"_blank",rel:"noreferrer",children:[e.jsx(Ie,{size:14})," Сайт"]}):null,((z=t.profile.links)==null?void 0:z.discord)&&e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-3 py-1",children:[e.jsx(ie,{size:14})," ",t.profile.links.discord]}),((L=t.profile.links)==null?void 0:L.telegram)&&e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-3 py-1",children:[e.jsx(ie,{size:14})," ",t.profile.links.telegram]}),!((A=t.profile.links)!=null&&A.website)&&!((B=t.profile.links)!=null&&B.discord)&&!(($=t.profile.links)!=null&&$.telegram)&&e.jsx("span",{className:"opacity-70",children:"Ссылки ещё не добавлены."})]})]})]}),p!=="about"&&e.jsxs("section",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:u,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.3em] text-zinc-400/80",children:"Посты"}),e.jsx("div",{className:"mt-1 text-3xl font-extrabold text-white",children:t.posts})]}),e.jsxs("div",{className:u,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.3em] text-zinc-400/80",children:"Темы"}),e.jsx("div",{className:"mt-1 text-3xl font-extrabold text-white",children:t.topics})]}),e.jsxs("div",{className:u,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.3em] text-zinc-400/80",children:"Лайки"}),e.jsx("div",{className:"mt-1 text-3xl font-extrabold text-white",children:t.likes})]})]}),p==="posts"&&e.jsx(Qe,{user:t,session:n,memberMap:b}),p==="activity"&&e.jsx("div",{className:w,children:e.jsx("div",{className:"text-sm text-zinc-300/85",children:"Лента активности скоро будет тут (репосты, реакции, подписки)."})}),p==="postings"&&e.jsx("div",{className:w,children:e.jsx("div",{className:"text-sm text-zinc-300/85",children:"Список сообщений пользователя появится после подключения реального форума."})})]})})}function Ke({session:s,user:t}){const[a,n]=i.useState(()=>t.id?ne(t.id):[]),r=i.useMemo(()=>Ae((s==null?void 0:s.id)||null,t.id),[s==null?void 0:s.id,t.id,a.length]);return e.jsx("button",{className:`btn ${r?"":"btn-primary"}`,onClick:()=>{s!=null&&s.id&&(r?$e(s.id,t.id):Re(s.id,t.id),n(ne(t.id)))},children:r?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{size:16})," Отписаться"]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{size:16})," Подписаться"]})})}function Qe({user:s,session:t,memberMap:a}){const[n,r]=i.useState(()=>P(s.id));return i.useEffect(()=>{const c=()=>r(P(s.id));return window.addEventListener("forum:social-change",c),()=>window.removeEventListener("forum:social-change",c)},[s.id]),e.jsxs("section",{className:"grid gap-3",children:[(t==null?void 0:t.id)&&e.jsx(et,{onPost:c=>{Ee(s.id,t.id,c,{authorName:t.username}),r(P(s.id))}}),e.jsxs("div",{className:"grid gap-2",children:[n.length===0&&e.jsx("div",{className:`${w} text-sm text-zinc-300/80`,children:"Комментариев пока нет."}),tt(n).map(c=>e.jsx(fe,{node:c,currentUserId:(t==null?void 0:t.id)||"",ownerId:s.id,memberMap:a,onReply:(d,m)=>{t!=null&&t.id&&(Fe(s.id,t.id,d,m,t.username),r(P(s.id)))},onDelete:d=>{t!=null&&t.id&&(Pe(s.id,d,t.id),r(P(s.id)))}},c.comment.id))]})]})}function et({onPost:s}){const[t,a]=i.useState("");return e.jsxs("div",{className:u,children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ge,{size:16,className:"mt-1 shrink-0"}),e.jsx("textarea",{className:"input min-h-[80px] flex-1",placeholder:"Напишите комментарий...",value:t,onChange:n=>a(n.target.value)})]}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>{const n=t.trim();n&&(s(n),a(""))},children:"Отправить"})})]})}function tt(s){const t={};s.forEach(r=>{t[r.id]={comment:r,replies:[]}});const a=[];s.forEach(r=>{const c=r.parentId||"";c&&t[c]?t[c].replies.push(t[r.id]):a.push(t[r.id])}),a.sort((r,c)=>r.comment.createdAt<c.comment.createdAt?1:-1);const n=r=>r.replies.sort((c,d)=>c.comment.createdAt>d.comment.createdAt?1:-1).forEach(n);return a.forEach(n),a}function fe({node:s,currentUserId:t,ownerId:a,onReply:n,onDelete:r,memberMap:c}){const[d,m]=i.useState(!1),x=ze(s.comment.authorId),b=s.comment.authorName||(x==null?void 0:x.username)||(s.comment.authorId===a?"Владелец":s.comment.authorId===t?"Вы":"Участник"),g=(x==null?void 0:x.username)||s.comment.authorName;return e.jsx("div",{className:u,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-8 w-8 shrink-0 rounded-full bg-gradient-to-br from-sky-500/60 to-violet-500/60"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs text-zinc-300/90",children:[g?e.jsx("a",{href:`/forum/profile/${g}`,className:"font-semibold text-white hover:underline",children:b}):e.jsx("span",{className:"font-semibold text-white",children:b}),e.jsxs("span",{className:"opacity-70",children:[" · ",new Date(s.comment.createdAt).toLocaleString("ru-RU")]})]}),(t===s.comment.authorId||t===a)&&e.jsx("button",{className:"btn",title:"Удалить",onClick:()=>r(s.comment.id),children:e.jsx(qe,{size:14})})]}),e.jsx("div",{className:"mt-1 whitespace-pre-wrap text-sm text-zinc-100/90",children:s.comment.content}),e.jsx(at,{targetId:a,commentId:s.comment.id,currentUserId:t}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:e.jsx("button",{className:"btn",onClick:()=>m(p=>!p),children:"Ответить"})}),d&&e.jsx("div",{className:"mt-2",children:e.jsx(st,{onSend:p=>{n(s.comment.id,p),m(!1)}})}),!!s.replies.length&&e.jsx("div",{className:"mt-3 space-y-2 border-l border-white/10 pl-3",children:s.replies.map(p=>e.jsx(fe,{node:p,currentUserId:t,ownerId:a,onReply:n,onDelete:r,memberMap:c},p.comment.id))})]})]})})}function st({onSend:s}){const[t,a]=i.useState("");return e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("textarea",{className:"input min-h-[60px] flex-1",placeholder:"Ответ...",value:t,onChange:n=>a(n.target.value)}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{const n=t.trim();n&&(s(n),a(""))},children:"Отправить"})]})}function at({targetId:s,commentId:t,currentUserId:a}){const[,n]=i.useReducer(m=>m+1,0),r=_e(s)[t]||{counts:{like:0,smile:0,useful:0}},c=a?De(s,t,a):void 0,d=({r:m,label:x})=>{var b;return e.jsxs("button",{className:`btn text-xs ${c===m?"btn-primary":""}`,onClick:()=>{a&&(Le(s,t,a,m),n())},children:[x," ",(b=r.counts)!=null&&b[m]?e.jsx("span",{className:"opacity-80",children:r.counts[m]}):null]})};return e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(d,{r:"like",label:"👍"}),e.jsx(d,{r:"smile",label:"😊"}),e.jsx(d,{r:"useful",label:"💡"})]})}function rt({user:s,onUpdated:t,saveProfile:a}){const[n,r]=i.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn",onClick:()=>r(!0),children:[e.jsx(Ue,{size:16})," Настроить профиль"]}),n&&e.jsx(nt,{user:s,onClose:()=>r(!1),onSaved:()=>{t(),r(!1)},saveProfile:a})]})}const lt=["Founder","Early","Contributor","VIP","Designer"];function nt({user:s,onClose:t,onSaved:a,saveProfile:n}){var q,Y,H,J,X,Z,K,Q,ee;const[r,c]=i.useState(s.profile.avatarData||""),[d,m]=i.useState(s.profile.bannerData||""),[x,b]=i.useState(s.profile.accentFrom||"#22d3ee"),[g,p]=i.useState(s.profile.accentTo||"#8b5cf6"),[F,I]=i.useState(s.profile.bio||""),[y,C]=i.useState(s.profile.signature||""),[v,N]=i.useState(((q=s.profile.links)==null?void 0:q.website)||""),[_,D]=i.useState(((Y=s.profile.links)==null?void 0:Y.discord)||""),[z,L]=i.useState(((H=s.profile.links)==null?void 0:H.telegram)||""),[A,B]=i.useState(s.profile.badges||[]),[$,o]=i.useState(((J=s.profile.privacy)==null?void 0:J.showEmail)??!1),[f,j]=i.useState(((X=s.profile.privacy)==null?void 0:X.showStats)??!0),[k,M]=i.useState(((Z=s.profile.privacy)==null?void 0:Z.showLinks)??!0),[R,T]=i.useState(((K=s.profile.privacy)==null?void 0:K.allowComments)??!0),[V,be]=i.useState(((Q=s.profile.privacy)==null?void 0:Q.showFollowers)??!0),[W,ge]=i.useState(((ee=s.profile.privacy)==null?void 0:ee.showSecondaryRole)!==!1),je=l=>B(h=>h.includes(l)?h.filter(S=>S!==l):h.length>=3?h:[...h,l]),G=l=>h=>{var te;const S=(te=h.target.files)==null?void 0:te[0];if(!S)return;const E=new FileReader;E.onload=()=>l(String(E.result||"")),E.readAsDataURL(S)},ve=async()=>{const l={website:v.trim(),discord:_.trim(),telegram:z.trim()},h=Object.fromEntries(Object.entries(l).filter(([,E])=>E)),S={...s.profile.privacy||{},showEmail:$,showStats:f,showLinks:k,allowComments:R,showFollowers:V,showSecondaryRole:W};await n({avatarData:r||void 0,bannerData:d||void 0,accentFrom:x,accentTo:g,bio:F.trim()||void 0,signature:y.trim()||void 0,links:Object.keys(h).length?h:void 0,badges:A,privacy:S}),a()};return e.jsx("div",{className:"fixed inset-0 z-[120] flex items-start justify-center bg-black/70 px-4 py-8 overflow-y-auto",children:e.jsxs("div",{className:`${w} w-[min(820px,96vw)]`,style:{position:"relative"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-lg font-semibold text-white",children:"Настройка профиля"}),e.jsx("button",{className:"btn",onClick:t,children:"Закрыть"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:u,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Аватар"}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("div",{className:"h-20 w-20 rounded-full",style:{background:r?`url(${r}) center/cover`:`linear-gradient(135deg, ${x}, ${g})`}}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"btn flex items-center gap-2",children:[e.jsx(me,{size:16})," Загрузить",e.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:G(c)})]}),r&&e.jsx("button",{className:"btn",onClick:()=>c(""),children:"Удалить"})]})]})]}),e.jsxs("div",{className:u,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Баннер"}),e.jsx("div",{className:"mt-3 h-20 w-full rounded-xl",style:{background:d?`url(${d}) center/cover`:`linear-gradient(135deg, ${x}, ${g})`}}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("label",{className:"btn flex items-center gap-2",children:[e.jsx(me,{size:16})," Загрузить",e.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:G(m)})]}),d&&e.jsx("button",{className:"btn",onClick:()=>m(""),children:"Удалить"})]})]}),e.jsxs("div",{className:u,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Градиент"}),e.jsxs("div",{className:"mt-3 flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-zinc-400/80",children:[e.jsx("span",{children:"От"}),e.jsx("input",{type:"color",value:x,onChange:l=>b(l.target.value)})]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs text-zinc-400/80",children:[e.jsx("span",{children:"До"}),e.jsx("input",{type:"color",value:g,onChange:l=>p(l.target.value)})]})]})]}),e.jsxs("div",{className:u,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Бейджи (до 3)"}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:lt.map(l=>{const h=A.includes(l);return e.jsxs("button",{className:`btn flex items-center gap-2 ${h?"btn-primary":""}`,onClick:()=>je(l),type:"button",children:[e.jsx(he,{size:16})," ",l]},l)})})]}),e.jsxs("div",{className:`${u} sm:col-span-2`,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"О себе"}),e.jsx("textarea",{className:"input mt-2 min-h-[120px]",value:F,onChange:l=>I(l.target.value),placeholder:"Расскажите о себе"})]}),e.jsxs("div",{className:`${u} sm:col-span-2`,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Подпись"}),e.jsx("textarea",{className:"input mt-2 min-h-[90px]",value:y,onChange:l=>C(l.target.value),placeholder:"Текст под сообщениями"})]}),e.jsxs("div",{className:`${u} sm:col-span-2`,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Ссылки"}),e.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-3",children:[e.jsx("input",{className:"input",placeholder:"https://website",value:v,onChange:l=>N(l.target.value)}),e.jsx("input",{className:"input",placeholder:"discord username",value:_,onChange:l=>D(l.target.value)}),e.jsx("input",{className:"input",placeholder:"@telegram",value:z,onChange:l=>L(l.target.value)})]})]}),e.jsxs("div",{className:`${u} sm:col-span-2`,children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.28em] text-zinc-400/80",children:"Приватность"}),e.jsxs("div",{className:"mt-3 grid gap-2 text-sm",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:$,onChange:l=>o(l.target.checked)})," Показывать e-mail"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:f,onChange:l=>j(l.target.checked)})," Показывать статистику"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:l=>M(l.target.checked)})," Показывать ссылки"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:V,onChange:l=>be(l.target.checked)})," Показывать подписчиков"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:R,onChange:l=>T(l.target.checked)})," Разрешить комментарии"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:W,onChange:l=>ge(l.target.checked)})," Показывать вторую роль"]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn",onClick:t,children:"Отмена"}),e.jsx("button",{className:"btn btn-primary",onClick:ve,children:"Сохранить"})]})]})]})})}export{pt as default};
